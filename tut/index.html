
<!DOCTYPE html>

<html class="no-js" lang="de">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://easyh.github.io/nerDH/tut/" rel="canonical"/>
<link href="../img/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.4.1, mkdocs-material-8.5.6" name="generator"/>
<title>NER Tutorial mit Spacy - NerDHTutorial</title>
<link href="../assets/stylesheets/main.20d9efc8.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.cbb835fc.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Multi+Regular:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Multi Regular";--md-code-font:"Roboto Mono"}</style>
<link href="../stylesheets/extra.css" rel="stylesheet"/>
<script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gdesc-inner { font-size: 0.75rem; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                </style><script src="../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="deep-purple" data-md-color-primary="teal" data-md-color-scheme="slate" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#ner-tutorial-mit-spacy">
          Zum Inhalt
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Kopfzeile" class="md-header__inner md-grid">
<a aria-label="NerDHTutorial" class="md-header__button md-logo" data-md-component="logo" href=".." title="NerDHTutorial">
<img alt="logo" src="../img/favicon.ico"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            NerDHTutorial
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              NER Tutorial mit Spacy
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="dark mode" class="md-option" data-md-color-accent="deep-purple" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="teal" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path></svg>
</label>
<input aria-label="light mode" class="md-option" data-md-color-accent="teal" data-md-color-media="" data-md-color-primary="teal" data-md-color-scheme="default" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"></path></svg>
</label>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Suche" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Suche" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Suche" class="md-search__options">
<button aria-label="Zurücksetzen" class="md-search__icon md-icon" tabindex="-1" title="Zurücksetzen" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Suche wird initialisiert
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/easyh/NerDH" title="Zum Repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</div>
<div class="md-source__repository">
    easyh/NerDH
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Hauptnavigation" class="md-tabs" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="..">
      Named Entity Recognition
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="./">
      NER Tutorial mit Spacy
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../gui/">
      NerDH Visualisierer
    </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="NerDHTutorial" class="md-nav__button md-logo" data-md-component="logo" href=".." title="NerDHTutorial">
<img alt="logo" src="../img/favicon.ico"/>
</a>
    NerDHTutorial
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/easyh/NerDH" title="Zum Repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</div>
<div class="md-source__repository">
    easyh/NerDH
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
        Named Entity Recognition
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          NER Tutorial mit Spacy
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        NER Tutorial mit Spacy
      </a>
<nav aria-label="Inhaltsverzeichnis" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Inhaltsverzeichnis
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#_1">
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#1-einfuhrung-in-spacy">
    1. Einführung in spaCy
  </a>
<nav aria-label="1. Einführung in spaCy" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#11-was-ist-spacy">
    1.1 Was ist spaCy?
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#12-installation-spacy">
    1.2 Installation spaCy
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_2">
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-erste-schritte-mit-spacy">
    2. Erste Schritte mit spaCy
  </a>
<nav aria-label="2. Erste Schritte mit spaCy" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#21-entitaten-erkennen">
    2.1 Entitäten erkennen
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#22-ner-visualisieren">
    2.2 NER visualisieren
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_3">
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-eigenes-modell-trainieren-mit-spacy">
    3. Eigenes Modell trainieren mit spaCy
  </a>
<nav aria-label="3. Eigenes Modell trainieren mit spaCy" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#31-preprocessing">
    3.1 Preprocessing
  </a>
<nav aria-label="3.1 Preprocessing" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#311-annotation-eines-goldstandards">
    3.1.1 Annotation eines Goldstandards
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#312-training-validierung-und-testdaten">
    3.1.2 Training-, Validierung- und Testdaten
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#33-training">
    3.3 Training
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#34-evaluierung">
    3.4 Evaluierung
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../gui/">
        NerDH Visualisierer
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/easyh/NerDH/edit/master/docs/tut.md" title="Seite editieren">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"></path></svg>
</a>
<h1 id="ner-tutorial-mit-spacy"><strong>NER Tutorial mit spaCy</strong></h1>
<p>In dem Tutorial werden wir das Natural Language Processing (NLP) Tool <code>spaCy</code> näher kennenlernen. Auch wenn <code>spaCy</code> im NLP Bereich mehr zu bieten hat als nur  Named Entity Recogniton (NER), wird darauf der Fokus des Tutorials liegen. </p>
<p>Starten werden wir mit einer allgemeinen Einführung in <code>spaCy</code>, in welcher wir die grundlegenden Funktionen für Textanalyseverfahren wie NER kennenlernen werden. </p>
<p>Im zweiten Teil des Tutorials werden wir Schritt für Schritt lernen, wie man mit <code>spaCy</code> ein eigenes NER Modell trainiert. Als Trainingstext wird der Reisebericht <a href="https://hainhofer.hab.de/reiseberichte/muenchen1611?v={%22view%22:%22info%22}" target="blank"><strong>München 1611</strong></a> aus der digitalen Edition <a href="https://hainhofer.hab.de/" target="blank"><strong>Philipp Hainhofer</strong></a> verwendet. Als Testtext <a href="https://hainhofer.hab.de/reiseberichte/muenchen1603" target="blank"><strong>München 1603</strong></a> aus der Edition.</p>
<details class="int"><summary>Jupyter Notebooks</summary><p>In diesem Tutorial werden lediglich die Code Beispiele dargestellt. Für die eigene Benutzung bieten sich folgende drei Möglichkeiten an:   </p>
<ul>
<li>
<p><a href="https://github.com/easyh/NerDH" target="blank">Github Repository Download</a> </p>
</li>
<li>
<p>Jupyter Notebook auf <a href="https://mybinder.org/v2/gh/easyh/NerDH/HEAD" target="blank">mybinder.org</a>
(durch die Verknüpfung des Github Repositorys sind die interaktiven Notebooks direkt im Browser zu verwenden.)</p>
</li>
<li>
<p>Kopieren des Codes in ein eigenes Dokument (Kopiersymbol in der rechten oberen Ecke).</p>
</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio"><input id="__tabbed_1_2" name="__tabbed_1" type="radio"><div class="tabbed-labels"><label for="__tabbed_1_1"><span class="twemoji"><svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></span> Github</label><label for="__tabbed_1_2"><span class="twemoji"><svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M64 96c0-35.3 28.7-64 64-64h384c35.3 0 64 28.7 64 64v256h-64V96H128v256H64V96zM0 403.2C0 392.6 8.6 384 19.2 384h601.6c10.6 0 19.2 8.6 19.2 19.2 0 42.4-34.4 76.8-76.8 76.8H76.8C34.4 480 0 445.6 0 403.2zM281 209l-31 31 31 31c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-48-48c-9.4-9.4-9.4-24.6 0-33.9l48-48c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9zm112-34 48 48c9.4 9.4 9.4 24.6 0 33.9l-48 48c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l31-31-31-31c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0z"></path></svg></span> mybinder.org</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><a class="md-button" href="https://github.com/easyh/NerDH" target="blank"><span class="twemoji"><svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></span> easyh/NerDH</a></p>
<div class="highlight"><pre><span></span><code>git clone https://github.com/easyh/NerDH.git
</code></pre></div>
<p><strong>Die Jupyter Notebooks sind im Ordner <code>notebooks</code> hinterlegt.</strong></p>
</div>
<div class="tabbed-block">
<p><a class="md-button" href="https://mybinder.org/v2/gh/easyh/NerDH/HEAD" target="blank">Hier geht es zu allen Jupyter Notebooks auf mybinder.org</a></p>
<p><strong>Das Laden des Workspaces wird einen kurzen Moment in Anspruch nehmen.</strong></p>
</div>
</div>
</input></input></div>
</details>
<p><br/>
<strong>Viel Spaß!</strong>
<br/></p>
<p><br/></p>
<hr/>
<h2 id="_1"></h2>
<h2 id="1-einfuhrung-in-spacy"><strong>1. Einführung in spaCy</strong></h2>
<p>Zunächst wird die Bibliothek <code>spaCy</code> von der theoretischen Seite vorgestellt. Anschließend werden wir die Schritte zur Installation von <code>spaCy</code> und zum Herunterladen der vortrainierten Sprachmodelle durchgehen. </p>
<h3 id="11-was-ist-spacy"><strong>1.1 Was ist spaCy?</strong></h3>
<p><code>spaCy</code> ist ein leistungsstarkes Tool zur Verarbeitung natürlicher Sprache. Die NLP-Bibliothek für maschinelles Lernen wird seit 2016 von <em>Explosion AI</em> stetig weiterentwickelt und befindet sich mittlerweile in der dritten Version (<code>v.3.4.1</code>). Das ist auch die Version, mit der wir hier im Tutorial arbeiten werden. <em>Explosion AI</em> ist ein Berliner Team aus Informatikern und Computerlinguisten. </p>
<p>Die Software-Bibiliothek unterstützt <a href="https://spacy.io/usage/models" target="blank">70 europäische Sprachen</a> mit statistischen Modellen, die in der Lage sind Texte zu parsen, Wortteile zu identifizieren und Entitäten zu extrahieren. Zudem ist <code>spaCy</code> auch in der Lage, benutzerdefinierte Modelle auf domänenspezifische Texte zu verbessern bzw. von Grund auf zu trainieren. Für 24 von 70 unterstützten Sprachen bietet <code>spaCy</code> bereits trainierte Pipelines mit unterschiedlichen Package-Größen an. Weitere sind in Aussicht.<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup> </p>
<details class="info"><summary>Leistungsumfang von spaCy</summary><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Programming Language</strong></td>
<td>Python</td>
<td></td>
</tr>
<tr>
<td><strong>Neural network methods</strong></td>
<td>Neuronale Netze sind eine Reihe von Algorithmen. Sie interpretieren sensorische Daten durch eine Art maschinelle Wahrnehmung, indem sie den rohen Input kennzeichnen oder in Gruppen zusammenfassen. Die Muster, die sie erkennen, sind numerisch und in Vektoren enthalten.</td>
<td><a href="https://spacy.io/usage/training" target="blank">Link</a></td>
</tr>
<tr>
<td><strong>Integrated word vectors</strong></td>
<td>Die Ähnlichkeit von Wörtern wird durch den Vergleich von Wortvektoren oder Worteinbettungen, mehrdimensionalen Bedeutungsdarstellungen eines Wortes, ermittelt. Wortvektoren können mit einem Algorithmus wie word2vec erzeugt werden</td>
<td><a href="https://spacy.io/usage/linguistic-features#vectors-similarity" target="blank">Link</a></td>
</tr>
<tr>
<td><strong>Multi-language support</strong></td>
<td>Unterstützt insgesamt 64 Sprachen und hat bereits trainierte Pipelines für 24 Sprachen.</td>
<td><a href="https://spacy.io/usage/models" target="blank">Link</a></td>
</tr>
<tr>
<td><strong>Tokenization</strong></td>
<td>Bei der Tokenisierung wird ein Text in Segemente wie Wörter oder Satzzeichen, so genannte Token, zerlegt. Die Eingabe für den Tokenizer ist ein Unicode-Text, und die Ausgabe ist ein Doc-Objekt.</td>
<td><a href="https://spacy.io/usage/linguistic-features#tokenization" target="blank">Link</a></td>
</tr>
<tr>
<td><strong>Part-of-Speech-Tagging</strong></td>
<td>Darunter versteht man die Zuordnung von Wörtern und Satzzeichen eines Textes zu Wortarten (engl. <em>part of speech</em>). Hierzu wird sowohl die Definition des Wortes als auch der Kontext berücksichtigt.</td>
<td><a href="https://spacy.io/usage/linguistic-features#pos-tagging" target="blank">Link</a></td>
</tr>
<tr>
<td><strong>Sentence segmentation</strong></td>
<td>Diese Aufgabe beinhaltet die Identifizierung von Satzgrenzen zwischen Wörtern in verschiedenen Sätzen.</td>
<td><a href="https://spacy.io/usage/linguistic-features#sbd" target="blank">Link</a></td>
</tr>
<tr>
<td><strong>Lemmatization</strong></td>
<td>Lemmatisierung ist der Prozess der Gruppierung der gebeugten Formen eines Wortes, damit sie als ein einziges Element analysiert werden können, das durch das Lemma des Wortes oder die Wörterbuchform identifiziert wird</td>
<td><a href="https://spacy.io/usage/linguistic-features#lemmatization" target="blank">Link</a></td>
</tr>
<tr>
<td><strong>Dependency Parsing</strong></td>
<td>Beim Dependency Parsing (DP) werden die Abhängigkeiten zwischen den Wörtern eines Satzes untersucht, um seine grammatische Struktur zu analysieren. Auf dieser Grundlage wird ein Satz in mehrere Komponenten zerlegt. Der Mechanismus basiert auf dem Konzept, dass es zwischen jeder sprachlichen Einheit eines Satzes eine direkte Verbindung gibt. Diese Verbindungen werden als Abhängigkeiten bezeichnet.</td>
<td><a href="https://spacy.io/usage/linguistic-features#dependency-parse" target="blank">Link</a></td>
</tr>
<tr>
<td><strong>Named Entity Recognition</strong></td>
<td>spaCy kann verschiedene Arten von benannten Entitäten in einem Dokument erkennen, indem es das Modell um eine Vorhersage bittet. Da Modelle statistisch sind und stark von den Beispielen abhängen, mit denen sie trainiert wurden, funktioniert dies nicht immer perfekt und muss je nach Anwendungsfall möglicherweise später angepasst werden.</td>
<td><a href="https://spacy.io/usage/linguistic-features#named-entities" target="blank">Link</a></td>
</tr>
<tr>
<td><strong>Named Entity Linking</strong></td>
<td>Um die benannten Entitäten in der "realen Welt" zu verankern, bietet spaCy Funktionen für das Entity Linking, bei dem eine textuelle Entität in einen eindeutigen Identifikator aus einer Wissensbasis (KB) aufgelöst wird. Es kann eine eigene KnowledgeBase erstellt und einen neuen EntityLinker mit dieser Wissensbasis trainiert werden.</td>
<td><a href="https://spacy.io/usage/linguistic-features#entity-linking" target="blank">Link</a></td>
</tr>
</tbody>
</table>
</details>
<p>Wie wir sehen, stellt Named Entity Recognition nur ein Bruchteil des Leistungsumfangs von <code>spaCy</code> dar. Daher ist ein Blick in die <a href="https://spacy.io/usage" target="blank">spaCy Dokumentation</a> für weiterführende Informationen sehr empfehlenswert. Ebenfalls zu empfehlen ist das <a href="https://course.spacy.io/de" target="blank">Tutorial von <code>spaCy</code></a>, welches den vollen Leistungsumfang berücksichtigt.</p>
<h3 id="12-installation-spacy"><strong>1.2 Installation spaCy</strong></h3>
<p>Um <code>spaCy</code> zu installieren, muss lediglich folgender Befehl im Terminal eingeben werden<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup>.</p>
<div class="highlight"><pre><span></span><code>pip install spacy
</code></pre></div>
<p>Wenn <code>spaCy</code> vorher noch nie verwendet wurde, müssen die Modelle/Pipelines noch heruntergeladen werden, damit wir mit diesen arbeiten können. Da wir NER mit deutschen Texten machen möchten, sind für uns erstmal nur die deutschen Sprachmodelle von <code>spaCy</code> interessant. </p>
<div class="admonition info">
<p class="admonition-title">spaCy Deutsche Sprackpakete<sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Precision</th>
<th>Recall</th>
<th>F-Score</th>
<th>NE-Typen</th>
<th>Word-Vectors</th>
<th>Größe</th>
</tr>
</thead>
<tbody>
<tr>
<td>de_core_news_sm</td>
<td>0.83</td>
<td>0.82</td>
<td>0.82</td>
<td>LOC, MISC, ORG, PER</td>
<td>0</td>
<td>13MB</td>
</tr>
<tr>
<td>de_core_news_md</td>
<td>0.85</td>
<td>0.84</td>
<td>0.84</td>
<td>LOC, MISC, ORG, PER</td>
<td>20.000</td>
<td>42MB</td>
</tr>
<tr>
<td>de_core_news_lg</td>
<td>0.85</td>
<td>0.85</td>
<td>0.85</td>
<td>LOC, MISC, ORG, PER</td>
<td>300.000</td>
<td>541MB</td>
</tr>
</tbody>
</table>
<p>Es gibt zwar noch das Paket <code>de_core_news_trf</code>, allerdings enthält das Paket keine NER-Pipeline, sodass es für unsere Zwecke nicht relevant ist. 
 Wie wir sehen, unterscheiden sich die Pakete besonders hinsichtlich ihrer Größe. Verantwortlich dafür ist die Anzahl der <strong>Word Vectors/Worteinbettungen</strong>. Eine höhere Anzahl von <strong>Word Vectors</strong> kann für die Ermittlung der Named Entites von Bedeutung sein. </p>
<p>Mehr Infos zu den Sprachpaketen von <code>spaCy</code> gibt es <a href="https://spacy.io/models/de" target="blank">hier</a>.</p>
<details class="question"><summary>Precision, Recall, F-Score<sup id="fnref:4"><a class="footnote-ref" href="#fn:4">4</a></sup></summary><p><strong>Precision:</strong> Berechnet man, indem man die Zahl der richtig gefundenen Vorkommnisse einer Kategorie durch die Gesamtzahl der Markierungen einer Kategorie teilt​. Wurden z.B. 100 Frauenfiguren im Text markiert, davon sind aber nur 97 richtig, so ist <code>P 97:100=0,97 oder 97%</code>.</p>
<p><strong>Recall:</strong> Berechnet man, indem man die Zahl der richtig gefundenen Vorkommnisse einer Kategorie durch die Gesamtzahl der tatsächlichen Vorkommnisse einer Kategorie teilt. Wurden z.B. 100 Frauenfiguren im Text richtig markiert, insgesamt gibt es aber 150 Ausdrücke, die Frauenfiguren bezeichnen, so ist <code>R 100:150=0,66 oder 66%</code>.</p>
<p><strong>F-Score:</strong> Kombiniert die Werte von Precision und Recall miteiander. Ein Wert nahe 1 bzw. 100% ist sehr gut.</p>
</details>
</div>
<p>Die Sprachpakete können mit folgenden Befehlen heruntergeladen werden.</p>
<p><div class="highlight"><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">spacy</span> <span class="n">download</span> <span class="n">de_core_news_sm</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">spacy</span> <span class="n">download</span> <span class="n">de_core_news_md</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">spacy</span> <span class="n">download</span> <span class="n">de_core_news_lg</span>
</code></pre></div></p>
<p>Mit folgendem Befehl können wir uns unsere <code>spaCy</code>-Version sowie die bereits installierten Modelle/Pipelines anzeigen lassen.</p>
<div class="highlight"><pre><span></span><code>python -m spacy info
</code></pre></div>
<p><br/></p>
<hr/>
<h2 id="_2"></h2>
<h2 id="2-erste-schritte-mit-spacy"><strong>2. Erste Schritte mit spaCy</strong></h2>
<p>Bevor wir nun mit der Erkennung von Named Entities und deren Visualisierung beginnen, lernen wir zunächst ein paar grundlegende Objekte und Funktionen von <code>spaCy</code> kennen. Bis auf den ersten Codeteil sind die anderen NLP-Funktionen für unsere NER-Aufgabe nicht wichtig, sollen aber dennoch kurz vorgestellt werden, da sie wichtige Grundlagen für Textanalysen sind.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio"><input id="__tabbed_2_2" name="__tabbed_2" type="radio"><div class="tabbed-labels"><label for="__tabbed_2_1">Code</label><label for="__tabbed_2_2">Output</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="c1">#zuerst importieren wir spaCy</span>
<a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="kn">import</span> <span class="nn">spacy</span>
<a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a>
<a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="c1">#in der Variable text ist der Text gespeichert, der analysiert werden soll.</span>
<a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="n">text</span> <span class="o">=</span> <span class="s2">"Mia Müller wohnt in Trier und studiert an der Universität Trier. Aufgewachsen ist sie in München mit ihrem Bruder Tom."</span>
<a href="#__codelineno-3-6" id="__codelineno-3-6" name="__codelineno-3-6"></a>
<a href="#__codelineno-3-7" id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="c1">#Als nächstes müssen wir ein Modellobjekt laden. </span>
<a href="#__codelineno-3-8" id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="c1">#Hierfür verwenden wir die Funktion spacy.load(). </span>
<a href="#__codelineno-3-9" id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="c1">#Diese nimmt ein Argument entgegen, nämlich das Modell, das wir laden möchten.</span>
<a href="#__codelineno-3-10" id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="c1">#Wir werden das kleine deutsche Modell verwenden.</span>
<a href="#__codelineno-3-11" id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">"de_core_news_sm"</span><span class="p">)</span>
<a href="#__codelineno-3-12" id="__codelineno-3-12" name="__codelineno-3-12"></a>
<a href="#__codelineno-3-13" id="__codelineno-3-13" name="__codelineno-3-13"></a><span class="c1">#Nachdem wir das nlp-Objekt erstellt haben, können wir es verwenden, um einen Text zu analysieren.</span>
<a href="#__codelineno-3-14" id="__codelineno-3-14" name="__codelineno-3-14"></a><span class="c1">#Zu diesem Zweck erstellen wir ein doc-Objekt.</span>
<a href="#__codelineno-3-15" id="__codelineno-3-15" name="__codelineno-3-15"></a><span class="c1">#Dieses Objekt wird eine Menge Daten über den Text enthalten.</span>
<a href="#__codelineno-3-16" id="__codelineno-3-16" name="__codelineno-3-16"></a><span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a href="#__codelineno-3-17" id="__codelineno-3-17" name="__codelineno-3-17"></a>
<a href="#__codelineno-3-18" id="__codelineno-3-18" name="__codelineno-3-18"></a><span class="c1">#Wir testen, ob das doc-Objekt unseren Text übernommen hat.</span>
<a href="#__codelineno-3-19" id="__codelineno-3-19" name="__codelineno-3-19"></a><span class="nb">print</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a>Mia Müller wohnt in Trier und studiert an der Universität Trier. Aufgewachsen ist sie in München mit ihrem Bruder Tom.
</code></pre></div>
</div>
</div>
</input></input></div>
<details class="code"><summary>Sentence Tokenizer</summary><div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio"><input id="__tabbed_3_2" name="__tabbed_3" type="radio"><div class="tabbed-labels"><label for="__tabbed_3_1">Code</label><label for="__tabbed_3_2">Output</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">sents</span><span class="p">:</span>
<a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">sent</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a>Mia Müller wohnt in Trier und studiert an der Universität Trier.
<a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a>Aufgewachsen ist sie in München mit ihrem Bruder Tom.
</code></pre></div>
</div>
</div>
</input></input></div>
</details>
<details class="code"><summary>Part-of-Speech Tagging</summary><div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio"/><input id="__tabbed_4_2" name="__tabbed_4" type="radio"/><div class="tabbed-labels"><label for="__tabbed_4_1">Code</label><label for="__tabbed_4_2">Output</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span> 
<a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">pos_</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a>Mia PROPN
<a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a>Müller PROPN
<a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a>wohnt VERB
<a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a>in ADP
<a href="#__codelineno-8-5" id="__codelineno-8-5" name="__codelineno-8-5"></a>Trier PROPN
<a href="#__codelineno-8-6" id="__codelineno-8-6" name="__codelineno-8-6"></a>und CCONJ
<a href="#__codelineno-8-7" id="__codelineno-8-7" name="__codelineno-8-7"></a>studiert VERB
<a href="#__codelineno-8-8" id="__codelineno-8-8" name="__codelineno-8-8"></a>an ADP
<a href="#__codelineno-8-9" id="__codelineno-8-9" name="__codelineno-8-9"></a>der DET
<a href="#__codelineno-8-10" id="__codelineno-8-10" name="__codelineno-8-10"></a>Universität NOUN
<a href="#__codelineno-8-11" id="__codelineno-8-11" name="__codelineno-8-11"></a>Trier PROPN
<a href="#__codelineno-8-12" id="__codelineno-8-12" name="__codelineno-8-12"></a>. PUNCT
<a href="#__codelineno-8-13" id="__codelineno-8-13" name="__codelineno-8-13"></a>Aufgewachsen VERB
<a href="#__codelineno-8-14" id="__codelineno-8-14" name="__codelineno-8-14"></a>ist AUX
<a href="#__codelineno-8-15" id="__codelineno-8-15" name="__codelineno-8-15"></a>sie PRON
<a href="#__codelineno-8-16" id="__codelineno-8-16" name="__codelineno-8-16"></a>in ADP
<a href="#__codelineno-8-17" id="__codelineno-8-17" name="__codelineno-8-17"></a>München PROPN
<a href="#__codelineno-8-18" id="__codelineno-8-18" name="__codelineno-8-18"></a>mit ADP
<a href="#__codelineno-8-19" id="__codelineno-8-19" name="__codelineno-8-19"></a>ihrem DET
<a href="#__codelineno-8-20" id="__codelineno-8-20" name="__codelineno-8-20"></a>Bruder NOUN
<a href="#__codelineno-8-21" id="__codelineno-8-21" name="__codelineno-8-21"></a>Tom PROPN
<a href="#__codelineno-8-22" id="__codelineno-8-22" name="__codelineno-8-22"></a>. PUNCT
</code></pre></div>
</div>
</div>
</div>
<details class="question"><summary>Erläuterung der POS-Tags</summary><table>
<thead>
<tr>
<th>POS-Tag</th>
<th>Erläuterung</th>
</tr>
</thead>
<tbody>
<tr>
<td>PROPN</td>
<td>Substantiv  (Name einer Person)</td>
</tr>
<tr>
<td>NOUN</td>
<td>Substantiv</td>
</tr>
<tr>
<td>VERB</td>
<td>Verben</td>
</tr>
<tr>
<td>ADJ</td>
<td>Adjektiv</td>
</tr>
<tr>
<td>ADV</td>
<td>Adverb</td>
</tr>
<tr>
<td>ADP</td>
<td>Prä-/Adpositionen</td>
</tr>
<tr>
<td>DET</td>
<td>Begleiter</td>
</tr>
<tr>
<td>AUX</td>
<td>Hilfsverb</td>
</tr>
<tr>
<td>PUNCT</td>
<td>Interpunktion</td>
</tr>
<tr>
<td>CCONJ</td>
<td>Konjunktion</td>
</tr>
</tbody>
</table>
</details>
</details>
<details class="code"><summary>Substantive und Substantiv-Bausteine extrahieren</summary><div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio"/><input id="__tabbed_5_2" name="__tabbed_5" type="radio"/><div class="tabbed-labels"><label for="__tabbed_5_1">Code</label><label for="__tabbed_5_2">Output</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">noun_chunks</span><span class="p">:</span>
<a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a>Mia
<a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a>Trier
<a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a>der Universität Trier
<a href="#__codelineno-10-4" id="__codelineno-10-4" name="__codelineno-10-4"></a>sie
<a href="#__codelineno-10-5" id="__codelineno-10-5" name="__codelineno-10-5"></a>München
<a href="#__codelineno-10-6" id="__codelineno-10-6" name="__codelineno-10-6"></a>ihrem Bruder Tom
</code></pre></div>
</div>
</div>
</div>
</details>
<details class="code"><summary>Verben extrahieren</summary><div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio"/><input id="__tabbed_6_2" name="__tabbed_6" type="radio"/><div class="tabbed-labels"><label for="__tabbed_6_1">Code</label><label for="__tabbed_6_2">Output</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="c1">#Verben sind im POS-TAg als "VERB" oder "AUX" definiert, daher iterieren wir über alle POS-TAGS, die übereinstimmen.</span>
<a href="#__codelineno-11-2" id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="n">verbs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"VERB"</span><span class="p">,</span> <span class="s2">"AUX"</span><span class="p">]</span>
<a href="#__codelineno-11-3" id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
<a href="#__codelineno-11-4" id="__codelineno-11-4" name="__codelineno-11-4"></a>    <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">pos_</span> <span class="ow">in</span> <span class="n">verbs</span><span class="p">:</span>
<a href="#__codelineno-11-5" id="__codelineno-11-5" name="__codelineno-11-5"></a>        <span class="nb">print</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">pos_</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a>wohnt VERB
<a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a>studiert VERB
<a href="#__codelineno-12-3" id="__codelineno-12-3" name="__codelineno-12-3"></a>Aufgewachsen VERB
<a href="#__codelineno-12-4" id="__codelineno-12-4" name="__codelineno-12-4"></a>ist AUX
</code></pre></div>
</div>
</div>
</div>
</details>
<details class="code"><summary>Lemmatisierung</summary><div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio"/><input id="__tabbed_7_2" name="__tabbed_7" type="radio"/><div class="tabbed-labels"><label for="__tabbed_7_1">Code</label><label for="__tabbed_7_2">Output</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
<a href="#__codelineno-13-2" id="__codelineno-13-2" name="__codelineno-13-2"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">token</span><span class="o">.</span><span class="n">lemma_</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a>Mia Mia
<a href="#__codelineno-14-2" id="__codelineno-14-2" name="__codelineno-14-2"></a>Müller Müller
<a href="#__codelineno-14-3" id="__codelineno-14-3" name="__codelineno-14-3"></a>wohnt wohnen
<a href="#__codelineno-14-4" id="__codelineno-14-4" name="__codelineno-14-4"></a>in in
<a href="#__codelineno-14-5" id="__codelineno-14-5" name="__codelineno-14-5"></a>Trier Trier
<a href="#__codelineno-14-6" id="__codelineno-14-6" name="__codelineno-14-6"></a>und und
<a href="#__codelineno-14-7" id="__codelineno-14-7" name="__codelineno-14-7"></a>studiert studieren
<a href="#__codelineno-14-8" id="__codelineno-14-8" name="__codelineno-14-8"></a>an an
<a href="#__codelineno-14-9" id="__codelineno-14-9" name="__codelineno-14-9"></a>der der
<a href="#__codelineno-14-10" id="__codelineno-14-10" name="__codelineno-14-10"></a>Universität Universität
<a href="#__codelineno-14-11" id="__codelineno-14-11" name="__codelineno-14-11"></a>Trier Trier
<a href="#__codelineno-14-12" id="__codelineno-14-12" name="__codelineno-14-12"></a>. --
<a href="#__codelineno-14-13" id="__codelineno-14-13" name="__codelineno-14-13"></a>Aufgewachsen aufgewachsen
<a href="#__codelineno-14-14" id="__codelineno-14-14" name="__codelineno-14-14"></a>ist sein
<a href="#__codelineno-14-15" id="__codelineno-14-15" name="__codelineno-14-15"></a>sie sie
<a href="#__codelineno-14-16" id="__codelineno-14-16" name="__codelineno-14-16"></a>in in
<a href="#__codelineno-14-17" id="__codelineno-14-17" name="__codelineno-14-17"></a>München München
<a href="#__codelineno-14-18" id="__codelineno-14-18" name="__codelineno-14-18"></a>mit mit
<a href="#__codelineno-14-19" id="__codelineno-14-19" name="__codelineno-14-19"></a>ihrem ihr
<a href="#__codelineno-14-20" id="__codelineno-14-20" name="__codelineno-14-20"></a>Bruder Bruder
<a href="#__codelineno-14-21" id="__codelineno-14-21" name="__codelineno-14-21"></a>Tom Tom
<a href="#__codelineno-14-22" id="__codelineno-14-22" name="__codelineno-14-22"></a>. --
</code></pre></div>
</div>
</div>
</div>
</details>
<h3 id="21-entitaten-erkennen"><strong>2.1 Entitäten erkennen</strong></h3>
<p>Der Code, um Named Entities in einem Dokument zu erkennen ist ähnlich simpel wie der Code der anderen Funktionen. Wir iterieren erneut über unser <code>doc-Objekt</code> mit der Funktion <code>.ents</code>. </p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio"/><input id="__tabbed_8_2" name="__tabbed_8" type="radio"/><div class="tabbed-labels"><label for="__tabbed_8_1">Code</label><label for="__tabbed_8_2">Output</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">:</span>
<a href="#__codelineno-15-2" id="__codelineno-15-2" name="__codelineno-15-2"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">text</span><span class="p">,</span><span class="n">ent</span><span class="o">.</span><span class="n">label_</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a>Mia Müller PER
<a href="#__codelineno-16-2" id="__codelineno-16-2" name="__codelineno-16-2"></a>Trier LOC
<a href="#__codelineno-16-3" id="__codelineno-16-3" name="__codelineno-16-3"></a>Universität Trier. ORG
<a href="#__codelineno-16-4" id="__codelineno-16-4" name="__codelineno-16-4"></a>München LOC
<a href="#__codelineno-16-5" id="__codelineno-16-5" name="__codelineno-16-5"></a>Tom. PER
</code></pre></div>
</div>
</div>
</div>
<p>Wie wir sehen, hat das kleine Sprachmodell hier sehr gute Arbeit geleistet. Alle vorkommenden Named Entities wurden richtig erkannt. Sogar die zwei Wörter <code>Universität</code> und  <code>Trier</code> wurden als <code>ORGANISATION</code> verstanden und nicht nur als <code>ORT</code>. Dieses Phänomen wird auch als <strong>Nested Entities</strong> bezeichnet, weil in einer Entität gleich mehrere stecken können.</p>
<p>Um beispielsweise nur die benannten Entitäten zu extrahieren, die als PERSON identifiziert wurden, können wir eine einfache if-Bedingung in den Mix einfügen.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio"/><input id="__tabbed_9_2" name="__tabbed_9" type="radio"/><div class="tabbed-labels"><label for="__tabbed_9_1">Code</label><label for="__tabbed_9_2">Output</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-17-1" id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">:</span>
<a href="#__codelineno-17-2" id="__codelineno-17-2" name="__codelineno-17-2"></a>    <span class="k">if</span> <span class="n">ent</span><span class="o">.</span><span class="n">label_</span> <span class="o">==</span> <span class="s2">"PER"</span><span class="p">:</span>
<a href="#__codelineno-17-3" id="__codelineno-17-3" name="__codelineno-17-3"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">ent</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-18-1" id="__codelineno-18-1" name="__codelineno-18-1"></a>Mia Müller
<a href="#__codelineno-18-2" id="__codelineno-18-2" name="__codelineno-18-2"></a>Tom.
</code></pre></div>
</div>
</div>
</div>
<p>Wir können uns zusätzlich noch ausgeben lassen, an welcher Stelle im Text die Named Entities zu finden sind. </p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:2"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio"/><input id="__tabbed_10_2" name="__tabbed_10" type="radio"/><div class="tabbed-labels"><label for="__tabbed_10_1">Code</label><label for="__tabbed_10_2">Output</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-19-1" id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">:</span>
<a href="#__codelineno-19-2" id="__codelineno-19-2" name="__codelineno-19-2"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">ent</span><span class="p">,</span><span class="n">start_char</span><span class="p">,</span> <span class="n">ent</span><span class="o">.</span><span class="n">end_char</span><span class="p">,</span> <span class="n">ent</span><span class="o">.</span><span class="n">label_</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-20-1" id="__codelineno-20-1" name="__codelineno-20-1"></a>Mia Müller 0 10 PER
<a href="#__codelineno-20-2" id="__codelineno-20-2" name="__codelineno-20-2"></a>Trier 20 25 LOC
<a href="#__codelineno-20-3" id="__codelineno-20-3" name="__codelineno-20-3"></a>Universität Trier. 46 64 ORG
<a href="#__codelineno-20-4" id="__codelineno-20-4" name="__codelineno-20-4"></a>München 89 96 LOC
<a href="#__codelineno-20-5" id="__codelineno-20-5" name="__codelineno-20-5"></a>Tom. 114 118 PER
</code></pre></div>
</div>
</div>
</div>
<h3 id="22-ner-visualisieren"><strong>2.2 NER visualisieren</strong></h3>
<p><code>spaCy</code> hat eine eingebaute Funktion zur Visualisierung der Entitäten namens <code>displacy</code>. Der schnellste Weg, ein <code>doc-Objekt</code> zu visualisieren ist <code>displacy.serve</code>. Dadurch wird ein einfacher Webserver gestartet und das Ergebnis kann im Browser betrachtet werden. Da wir innerhalb eines Jupyter Notebooks arbeiten, verwenden wir die Funktion <code>displacy.render</code>. Dazu müssen wir zunächst noch <code>displacy</code> importieren.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio"/><input id="__tabbed_11_2" name="__tabbed_11" type="radio"/><div class="tabbed-labels"><label for="__tabbed_11_1">Code</label><label for="__tabbed_11_2">Output</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-21-1" id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="kn">from</span> <span class="nn">spacy</span> <span class="kn">import</span> <span class="n">displacy</span>
<a href="#__codelineno-21-2" id="__codelineno-21-2" name="__codelineno-21-2"></a>
<a href="#__codelineno-21-3" id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="n">displacy</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">"ent"</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><div>
<figure style="margin-bottom: 1rem">
<div class="entities" style="line-height: 2.5; direction: ltr">
<mark class="entity" style="color: black; background: #ddd; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Mia Müller
    <span style="font-size: 0.6em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PER</span>
</mark>
wohnt in 
<mark class="entity" style="color: black; background: #ff9561; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Trier
    <span style="font-size: 0.6em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">LOC</span>
</mark>
und studiert an der 
<mark class="entity" style="color: black; background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Universität Trier.
    <span style="font-size: 0.6em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
Aufgewachsen ist sie in 
<mark class="entity" style="color: black; background: #ff9561; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    München
    <span style="font-size: 0.6em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">LOC</span>
</mark>
mit ihrem Bruder 
<mark class="entity" style=" color: black; background: #ddd; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Tom.
    <span style="font-size: 0.6em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PER</span>
</mark>
</div>
</figure>
</div></p>
</div>
</div>
</div>
<p>Hier können wir jetzt noch eigene Anpassungen wie die Auswahl der Entitäten oder auch die Farbe ausführen. Die individuellen Farben geben wir für alle vier Entitätstypen an, allerdings wollen wir uns hier nur die Personen (<code>PER</code>) und Orte (<code>LOC</code>) ausgeben lassen.    </p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:2"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio"/><input id="__tabbed_12_2" name="__tabbed_12" type="radio"/><div class="tabbed-labels"><label for="__tabbed_12_1">Code</label><label for="__tabbed_12_2">Output</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-22-1" id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"PER"</span><span class="p">:</span> <span class="s2">"#fdec3e"</span><span class="p">,</span> <span class="s2">"LOC"</span><span class="p">:</span> <span class="s2">"#7e56c2"</span><span class="p">,</span> <span class="s2">"ORG"</span><span class="p">:</span> <span class="s2">"#209485"</span> <span class="p">,</span> <span class="s2">"MISC"</span><span class="p">:</span> <span class="s2">"#eb4034"</span><span class="p">}</span>
<a href="#__codelineno-22-2" id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"ents"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"PER"</span><span class="p">,</span> <span class="s2">"LOC"</span><span class="p">],</span> <span class="s2">"colors"</span><span class="p">:</span> <span class="n">colors</span><span class="p">}</span>
<a href="#__codelineno-22-3" id="__codelineno-22-3" name="__codelineno-22-3"></a>
<a href="#__codelineno-22-4" id="__codelineno-22-4" name="__codelineno-22-4"></a><span class="n">displacy</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">"ent"</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><div>
<figure style="margin-bottom: 1rem">
<div class="entities" style="line-height: 2.5; direction: ltr">
<mark class="entity" style="color: black; background: #fdec3e; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Mia Müller
    <span style="font-size: 0.6em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PER</span>
</mark>
wohnt in 
<mark class="entity" style="color: black; background: #7e56c2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Trier
    <span style="font-size: 0.6em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">LOC</span>
</mark>
und studiert an der Universität Trier.
Aufgewachsen ist sie in 
<mark class="entity" style="color: black; background: #7e56c2; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    München
    <span style="font-size: 0.6em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">LOC</span>
</mark>
mit ihrem Bruder 
<mark class="entity" style=" color: black; background: #fdec3e; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Tom.
    <span style="font-size: 0.6em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PER</span>
</mark>
</div>
</figure>
</div></p>
</div>
</div>
</div>
<p><br/></p>
<div class="admonition int">
<p class="admonition-title">Jupyter Notebooks</p>
<p>Der Code zu diesem Kapitel befindet sich hier: <code>notebooks/01_firstSteps_spacy.ipynb</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:2"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio"/><input id="__tabbed_13_2" name="__tabbed_13" type="radio"/><div class="tabbed-labels"><label for="__tabbed_13_1"><span class="twemoji"><svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></span> Github</label><label for="__tabbed_13_2"><span class="twemoji"><svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M64 96c0-35.3 28.7-64 64-64h384c35.3 0 64 28.7 64 64v256h-64V96H128v256H64V96zM0 403.2C0 392.6 8.6 384 19.2 384h601.6c10.6 0 19.2 8.6 19.2 19.2 0 42.4-34.4 76.8-76.8 76.8H76.8C34.4 480 0 445.6 0 403.2zM281 209l-31 31 31 31c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-48-48c-9.4-9.4-9.4-24.6 0-33.9l48-48c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9zm112-34 48 48c9.4 9.4 9.4 24.6 0 33.9l-48 48c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l31-31-31-31c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0z"></path></svg></span> mybinder.org</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><a class="md-button" href="https://github.com/easyh/NerDH/blob/main/notebooks/01_firstSteps_spacy.ipynb" target="blank">Hier geht es zum Notebook auf Github</a></p>
</div>
<div class="tabbed-block">
<p><a class="md-button" href="https://mybinder.org/v2/gh/easyh/NerDH/HEAD" target="blank">Hier geht es zum Jupyter Notebook auf mybinder.org</a></p>
<p><strong>Das Laden des Workspaces wird einen kurzen Moment in Anspruch nehmen.</strong></p>
</div>
</div>
</div>
</div>
<p><br/></p>
<hr/>
<h2 id="_3"></h2>
<h2 id="3-eigenes-modell-trainieren-mit-spacy"><strong>3. Eigenes Modell trainieren mit spaCy</strong></h2>
<p>Je nach Anwendungsfall ergibt es wenig Sinn nur mit dem Standardmodell zu arbeiten, weshalb es besser ist, ein neues Modell zu trainieren bzw. auf ein bestehendes aufzubauen. Besonders bei historischen Texten entstehen Probleme und Schwierigkeiten aufgrund ihrer Heterogenität. </p>
<div class="admonition ex">
<p class="admonition-title">NER mit fnhd. Text</p>
<p>Folgendes Beispiel zeigt, wie das kleine <code>spaCy</code> Sprachmodell mit einem Satz aus dem frühneuhochdeutschen abschneidet. Der Satz ist aus unserem Traningstext <a href="https://hainhofer.hab.de/reiseberichte/muenchen1611?v={%22view%22:%22info%22}" target="blank"><strong>München 1611</strong></a> von Philipp Hainhofer.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:2"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio"/><input id="__tabbed_14_2" name="__tabbed_14" type="radio"/><div class="tabbed-labels"><label for="__tabbed_14_1">Code</label><label for="__tabbed_14_2">Output</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-23-1" id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="n">text_fnhd</span> <span class="o">=</span> <span class="s2">"Aines mörders Conterfett, genant Christoff Froschhammer von Vlingingen, der Hat 345 mörd, mit seiner aignen hand, vnd 400 mord in gesellschafft anderer, gethan, ist Anno 1578 zu Welß in Steÿrmarck gerichtet worden, vnd auß dem stifft Saltzburg gebürtig gewesen."</span>
<a href="#__codelineno-23-2" id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">"de_core_news_sm"</span><span class="p">)</span>
<a href="#__codelineno-23-3" id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="n">doc_fnhd</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">text_fnhd</span><span class="p">)</span>
<a href="#__codelineno-23-4" id="__codelineno-23-4" name="__codelineno-23-4"></a><span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc_fnhd</span><span class="o">.</span><span class="n">ents</span><span class="p">:</span>
<a href="#__codelineno-23-5" id="__codelineno-23-5" name="__codelineno-23-5"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">text</span><span class="p">,</span><span class="n">ent</span><span class="o">.</span><span class="n">label_</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-24-1" id="__codelineno-24-1" name="__codelineno-24-1"></a>Aines mörders MISC
<a href="#__codelineno-24-2" id="__codelineno-24-2" name="__codelineno-24-2"></a>Christoff Froschhammer PER
<a href="#__codelineno-24-3" id="__codelineno-24-3" name="__codelineno-24-3"></a>Anno LOC
<a href="#__codelineno-24-4" id="__codelineno-24-4" name="__codelineno-24-4"></a>Welß PER
<a href="#__codelineno-24-5" id="__codelineno-24-5" name="__codelineno-24-5"></a>Steÿrmarck MISC
<a href="#__codelineno-24-6" id="__codelineno-24-6" name="__codelineno-24-6"></a>Saltzburg LOC
</code></pre></div>
</div>
</div>
</div>
<p>Wie wir sehen wurden nur zwei Entitäten richtig erkannt: <code>Christoff Froschhammer</code> als <code>PERSON</code> und <code>Saltzburg</code> als <code>ORT</code>. <code>Vlingingen</code>, sowie <code>Welß</code> und <code>Steÿrmarck</code> wurden nicht richtig oder garnicht als <code>ORT</code> erkannt. Zudem hat das Modell Entitäten erkannt, die eigentlich keine Entitäten sind: <code>Anno</code> und <code>Aines mörder</code>.</p>
</div>
<p>Vor dem Training eines eigenen NER-Modells ist es wichtig, folgende drei Fragen zu klären: </p>
<details class="question"><summary>Was sind die Daten?</summary><p>Unsere Daten entstammen der digitalen Edition <a href="https://hainhofer.hab.de/" target="blank"><strong>Philipp Hainhofer</strong></a>. Hier haben wir uns für den Reisebericht <a href="https://hainhofer.hab.de/reiseberichte/muenchen1611?v={%22view%22:%22info%22}" target="blank"><strong>München 1611</strong></a> als Trainingstext und <a href="https://hainhofer.hab.de/reiseberichte/muenchen1603" target="blank"><strong>München 1603</strong></a> als Testtext entschieden. Die Texte der Edition stehen in <code>TEI-XML</code>, <code>PDF</code> sowie <code>TXT</code> zum Download verfügbar. Wir verwenden die Daten im  <code>TXT</code>-Format, denn einige Studien haben gezeigt, dass eine umfangreiche XML-Annotation, die dem NER-Prozess vorausgeht, die Leistung beeinträchtigen kann. NER-Systeme sollten daher idealerweise angewendet werden, bevor ein Korpus mit Standards wie TEI annotiert wird. In dieser Reihenfolge können die NER-Ergebnisse dann auch bei der TEI-Codierung sehr hilfreich sein. </p>
</details>
<details class="question"><summary>Welche Entitäten möchte ich auswählen?</summary><p>Hier geht es darum, die relevanten Kategorien und Entitäten auszuwählen. Dafür ist es wichtig zu wissen, welche und wie viele NE-Katogorien man für die jeweiligen Texte verwenden will.</p>
<p>In unserem Modell werden wir die folgenden Entitäten trainieren: </p>
<table>
<thead>
<tr>
<th>Named Entities</th>
<th>Beschreibung</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>PERSON</code></td>
<td>Einzelperson oder Familie</td>
</tr>
<tr>
<td><code>ORT</code></td>
<td>Geographische Einheit, d. h. Länder, Städte, Staaten, Flüsse</td>
</tr>
<tr>
<td><code>ORGANISATION</code></td>
<td>Institutionen,(Ordens-)Gemeinschaften, Verbindungen, etc.</td>
</tr>
<tr>
<td><code>OBJEKT</code></td>
<td>Architektur, Gebäude, Kunst, Werke etc.</td>
</tr>
<tr>
<td><code>ZEIT</code></td>
<td>Datum, Monat, Jahr, Uhrzeit etc.</td>
</tr>
</tbody>
</table>
</details>
<details class="question"><summary>Wie möchte ich diese Entitäten kennzeichen?</summary><p>Hier geht es darum, wie die Entitäten annotiert werden. Dabei sollte sich auf eine einheitliche Annotationskonvention beschränkt werden. Das Ergebnis sollte am Ende ein Goldstandard sein, anhand dessen später das NER-Modell bewertet wird, indem die per Hand angefertigen Annotationen mit der Ausgabe des NER-Systems verglichen werden. </p>
</details>
<p>Im Laufe dieses Kapitels werden wir lernen, wie das Training eines eigenen Modells mit <code>spaCy</code> umgesetzt wird. Unser Workflow für das Training eines eigenen NER-Modells sieht wie folgt aus: </p>
<figure>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../img/workflow.svg"><img alt="Annotation Goldtstandard" src="../img/workflow.svg" width="500"/></a>
</p>
<figcaption style="font-size: 0.8em;">Workflow: Training eines eigenen NER Modells</figcaption>
</figure>
<h3 id="31-preprocessing"><strong>3.1 Preprocessing</strong></h3>
<p>Bevor wir mit dem Trainings- und dem anschließenden Evaluierungsprozess starten, müssen wir zunächst einen Goldstandard erstellen und diesen dann in Trainings-, Validierungs- &amp; Testdaten aufteilen. Dieser Schritt gehört zum sogennanten <strong>Preprocessing</strong> des maschinellen Lernens. </p>
<p>Vor der Annotation des Goldstandards, sollten wir unsere beiden Texte allerdings noch etwas kennenlernen und vorbereiten. Auf die nähere Ausführung soll an dieser Stelle verzichtet werden, allerdings ist alles Wichtige zu diesem Schritt im Notebook <code>02_preprocessingText.ipynb</code> festgehalten.</p>
<div class="admonition int">
<p class="admonition-title">Jupyter Notebooks</p>
<p>Der Code zu diesem Kapitel befindet sich hier: <code>notebooks/02_preprocessingText.ipynb</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="15:2"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio"/><input id="__tabbed_15_2" name="__tabbed_15" type="radio"/><div class="tabbed-labels"><label for="__tabbed_15_1"><span class="twemoji"><svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></span> Github</label><label for="__tabbed_15_2"><span class="twemoji"><svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M64 96c0-35.3 28.7-64 64-64h384c35.3 0 64 28.7 64 64v256h-64V96H128v256H64V96zM0 403.2C0 392.6 8.6 384 19.2 384h601.6c10.6 0 19.2 8.6 19.2 19.2 0 42.4-34.4 76.8-76.8 76.8H76.8C34.4 480 0 445.6 0 403.2zM281 209l-31 31 31 31c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-48-48c-9.4-9.4-9.4-24.6 0-33.9l48-48c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9zm112-34 48 48c9.4 9.4 9.4 24.6 0 33.9l-48 48c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l31-31-31-31c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0z"></path></svg></span> mybinder.org</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><a class="md-button" href="https://github.com/easyh/NerDH/blob/main/notebooks/02_preprocessingText.ipynb" target="blank">Hier geht es zum Notebook auf Github</a></p>
</div>
<div class="tabbed-block">
<p><a class="md-button" href="https://mybinder.org/v2/gh/easyh/NerDH/HEAD" target="blank">Hier geht es zum Jupyter Notebook auf mybinder.org</a></p>
<p><strong>Das Laden des Workspaces wird einen kurzen Moment in Anspruch nehmen.</strong></p>
</div>
</div>
</div>
</div>
<p><br/></p>
<h4 id="311-annotation-eines-goldstandards"><strong>3.1.1 Annotation eines Goldstandards</strong></h4>
<p>Die Annotation des Goldstandrds ist der erste wichtige Schritt, um ein Trainingskorpus zu erstellen. </p>
<div class="admonition goldstandard info">
<p class="admonition-title">Goldstandard</p>
<p>Ein Goldstandard ist eine manuelle Referenz-Annotation, bei der die relevanten Named Entities annotiert werden. Es ist die finale Version der annotierten Daten, die für den Trainingsprozess verwendet werden. Je besser und genauer die Auszeichnungen für den Goldstandard gemacht werden, desto besser ist das Trainingsergebnis. Anhand des Goldstandards, kann später die Qualität eines NER-Modell bewertet werden, quantifziert als Recall, Precision und F-Score.</p>
</div>
<p>Es gibt mehrere Möglichkeiten Texte so zu annotieren, dass sie maschinenlesbar sind. Hier muss je nach Anwendungsbereich entschieden werden, welcher Annotationsstandard der passendste ist. In den Digital Humanities werden die meisten Texte mithilfe der auf XML basierenden Anwendung der <a href="https://tei-c.org/" target="blank">Text Encoding Initiative (TEI)</a> annotiert. Ein anderer bekannter Standard zum Annotieren von Named Entities ist das <a href="https://en.wikipedia.org/wiki/Inside%E2%80%93outside%E2%80%93beginning_(tagging)" target="blank">IOB-Schema</a> (bzw. BIO-Schema). </p>
<p>Da wir allerdings ein NER-Modell mit <code>spaCy</code> trainieren wollen, müssen wir unseren Goldstandard entsprechend für die Software anpassen. <code>spaCy</code> verlangt ein spezielles Traningsformat, in welchem die Daten vorliegen müssen. Das Beispiel zeigt das klassische Format: </p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-25-1" id="__codelineno-25-1" name="__codelineno-25-1"></a>TRAIN_DATA = ["TEXT AS A STRING",{"entities:"[(START,END,LABEL)]}]
</code></pre></div>
<p>Es gibt zahlreiche Auszeichnungstools, die für Anwendungen des maschinellen Lernens entwickelt wurden und bei der Annotation von Texten helfen. Darunter auch einige, welche die Daten direkt in das entsprechende Trainingsformat für <code>spaCy</code> bringen. Dafür wurde speziell <a href="https://prodi.gy/" target="blank"><code>prodigy</code></a>  entwickelt, was allerdings kostenpflichtig ist. Aber es gibt auch einige Open-Source-Programme, die eine gute Alternative darstellen. </p>
<p>Wir haben unseren Goldstandard mit dem <a href="https://tecoholic.github.io/ner-annotator/" target="blank">NER-Annotator</a> erstellt. Hier kann ein Text im <code>TXT</code>-Format importiert, annotiert und dann anschließend im <code>JSON</code>-Format exportiert werden. Die <code>JSON</code>-Datei enthält dann die annotierten Daten, die in dem für <code>spaCy</code> geeigneten Format vorliegen. Allerdings müssen die <code>JSON</code>-Dateien für den Trainingsprozess nochmal in <code>.spacy</code>-Dateien umgewandelt werden. 
Der Codeteil, in welchem die Daten zunächst in ein <code>doc</code> und dann in ein <code>docBin</code> Objekt konvertiert werden,
stammt von Explosian AI - den Machern von spaCy - selbst. Verwenden werden wir das angepasste Codeschnipsel von <a href="https://web.archive.org/web/20230119162746/https://towardsdatascience.com/using-spacy-3-0-to-build-a-custom-ner-model-c9256bea098?gi=fa93a146dfd7" target="blank">hier</a>.</p>
<p>Das folgende Bild zeigt, wie die Annotation erfolgt. In der oberen Zeile können die Entitäten Kategorien festgelegt werden. Ist eine Kategorie mit einem Haken markiert (hier <code>ORT</code>) kann im Text damit die entsprechende Entität markiert werden. So arbeiten wir uns Stück für Stück durch unseren Text, bis wir fertig sind. Enthält ein Satz keine Entitäten, dann überspringen (<code>skip</code>) wir diesen. In unserer Datei sind später nur Sätze enthalten, die Entitäten enthalten.</p>
<figure>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../img/history_example.png"><img alt="Annotation Goldtstandard" src="../img/history_example.png" width="700"/></a>
</p>
<figcaption style="font-size: 0.8em;">Erstellung des Goldstandards für das Training mit dem NER-Annotator-for-spaCy. </figcaption>
</figure>
<p>In der <code>JSON</code>-Datei ist dieser Satz dann im folgenden Format wieder zu finden: </p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-26-1" id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="p">{</span><span class="nt">"classes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"PERSON"</span><span class="p">,</span><span class="s2">"ORT"</span><span class="p">,</span><span class="s2">"ORGANISATION"</span><span class="p">,</span><span class="s2">"OBJEKT"</span><span class="p">,</span><span class="s2">"ZEIT"</span><span class="p">],</span><span class="w"></span>
<a href="#__codelineno-26-2" id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="w">    </span><span class="nt">"annotations"</span><span class="p">:</span><span class="w"> </span><span class="p">[[</span><span class="s2">"Aines mörders Conterfett, genant Christoff Froschhammer von Vlingingen, der Hat 345 mörd, </span>
<a href="#__codelineno-26-3" id="__codelineno-26-3" name="__codelineno-26-3"></a><span class="s2">            mit seiner aignen hand, vnd 400 mord in gesellschafft anderer, gethan, ist Anno 1578 zu Welß </span>
<a href="#__codelineno-26-4" id="__codelineno-26-4" name="__codelineno-26-4"></a><span class="s2">            in Steÿrmarck gerichtet worden, vnd auß dem stifft Saltzburg gebürtig gewesen."</span><span class="p">,</span><span class="w"></span>
<a href="#__codelineno-26-5" id="__codelineno-26-5" name="__codelineno-26-5"></a><span class="w">        </span><span class="p">{</span><span class="nt">"entities"</span><span class="p">:</span><span class="w"> </span><span class="p">[[</span><span class="mi">33</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="s2">"PERSON"</span><span class="p">],[</span><span class="mi">60</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="s2">"ORT"</span><span class="p">],[</span><span class="mi">165</span><span class="p">,</span><span class="mi">174</span><span class="p">,</span><span class="s2">"ZEIT"</span><span class="p">],[</span><span class="mi">178</span><span class="p">,</span><span class="mi">182</span><span class="p">,</span><span class="s2">"ORT"</span><span class="p">],[</span><span class="mi">186</span><span class="p">,</span><span class="mi">196</span><span class="p">,</span><span class="s2">"ORT"</span><span class="p">],[</span><span class="mi">234</span><span class="p">,</span><span class="mi">243</span><span class="p">,</span><span class="s2">"ORT"</span><span class="p">]]}]]}</span><span class="w"></span>
</code></pre></div>
<p>Der Prozess des Annotierens kann je nach Länge des Textes sehr aufwändig und anstrengend sein. Bei sehr langen Texten bietet es sich an, den Text in einzelne Dateien zu unterteilen, um dann in Etappen die Annotation durchzuführen. Am Ende können die einzelnen <code>JSON</code>-Dateien dann wieder zu einer Datei zusammengefügt werden, die dann den finalen Goldstandard darstellt. </p>
<div class="admonition info">
<p class="admonition-title">Die folgende Tabelle soll einen kurzen Überblick über den Trainingstext  <a href="https://hainhofer.hab.de/reiseberichte/muenchen1611" target="blank"><strong>München 1611</strong></a> und den Testtext <a href="https://hainhofer.hab.de/reiseberichte/muenchen1603" target="blank"><strong>München 1603</strong></a> und dessen annotierten Enititäten geben.</p>
<table>
<thead>
<tr>
<th> Text</th>
<th>Sätze</th>
<th>Tokens/Wörter</th>
<th>Zeichen</th>
<th><code>PERSON</code></th>
<th><code>ORT</code></th>
<th><code>ORG</code></th>
<th><code>OBJEKT</code></th>
<th><code>ZEIT</code></th>
<th>Gesamt Entitäten</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://hainhofer.hab.de/reiseberichte/muenchen1611" target="blank"><strong>München 1611</strong></a></td>
<td>1 595</td>
<td>41 087</td>
<td>225 952</td>
<td>1019</td>
<td>840</td>
<td>63</td>
<td>238</td>
<td>451</td>
<td>2611</td>
</tr>
<tr>
<td><a href="https://hainhofer.hab.de/reiseberichte/muenchen1603" target="blank"><strong>München 1603</strong></a></td>
<td>147</td>
<td>5 928</td>
<td>31 747</td>
<td>54</td>
<td>55</td>
<td>16</td>
<td>53</td>
<td>22</td>
<td>200</td>
</tr>
<tr>
<td><strong>GESAMT</strong></td>
<td>1 742</td>
<td>47 015</td>
<td>257 699</td>
<td>1073</td>
<td>895</td>
<td>79</td>
<td>291</td>
<td>473</td>
<td>2811</td>
</tr>
</tbody>
</table>
</div>
<p>Der Goldstandard für den Traningstext befindet sich <a href="https://github.com/easyh/NerDH/blob/main/data/datensets/taggedData.json" target="blank"><strong>hier <span class="twemoji"><svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></span></strong></a> (<code>data/datensets/taggedData.json</code>).</p>
<p><br/></p>
<h4 id="312-training-validierung-und-testdaten"><strong>3.1.2 Training-, Validierung- und Testdaten</strong></h4>
<p>Beim maschinellen Lernen benötigen wir einen Trainingsdatensatz, um ein Modell richtig zu trainieren und einen Testdatensatz, um das Modell zu bewerten.  Der Datensatz <a href="https://github.com/easyh/NerDH/blob/main/data/datensets/taggedData.json" target="blank"><code>taggedData.json</code></a> umfasst den komplett annotierten Text <a href="https://hainhofer.hab.de/reiseberichte/muenchen1611?v={%22view%22:%22info%22}" target="blank"><strong>München 1611</strong></a>. Bei <strong>überwachten Lernmethoden</strong> wird dieser Datensatz in der Regel in mindestens drei verschiedene Datensätze unterteilt: <strong>Training-, Validierung- und Testdaten</strong>. In unserem Fall übernehmen die Trainingsdaten (<a href="https://github.com/easyh/NerDH/blob/main/data/datensets/taggedData.json" target="blank"><code>testData.json</code></a>) bei uns die annotierten Daten aus dem Text <a href="https://hainhofer.hab.de/reiseberichte/muenchen1603" target="blank"><strong>München 1603</strong></a>.</p>
<details class="info"><summary>Überwachtes Lernen</summary><p>In unserem Fall arbeiten wir mit der  <strong>überwachten Lernmethode</strong>, bei der Beispieldaten in Form eines annotierten Goldstandards notwendig sind, damit der Algorithmus lernen kann.  Bei der <strong>unüberwachten Lernmethode</strong> hingegen bräuchten wir keine Beispiele, da hier direkt mit den Eingabedaten trainiert wird und der Algorithmus hier von selbst Muster und Zusammenhänge lernen würde. </p>
</details>
<p>Die Aufteilung unsrer Daten sieht wie folgt aus. Den Datensatz <a href="https://github.com/easyh/NerDH/blob/main/data/datensets/taggedData.json" target="blank"><code>taggedData.json</code></a> werden wir noch in <strong>Trainingsdaten</strong> und <strong>Validierungsdaten</strong> einteilen müssen.</p>
<figure>
<p><a class="glightbox" data-desc-position="bottom" data-description="" data-height="auto" data-title="" data-width="100%" href="../img/datenset.png"><img alt="Datensetsverteilung" src="../img/datenset.png" width="500"/></a>
</p>
<figcaption style="font-size: 0.8em;">Aufteilung in Training-, Validierung- und Testdaten. </figcaption>
</figure>
<details class="info"><summary>Training-, Validierung- und Testdaten<sup id="fnref:7"><a class="footnote-ref" href="#fn:7">5</a></sup></summary><table>
<thead>
<tr>
<th>Datensatz</th>
<th>Anteil</th>
<th>Erklärung</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Traningsdaten</strong></td>
<td>70%</td>
<td>Ein Trainingsdatensatz ist eine Sammlung von Beispielen, die verwendet werden, um einem Algorithmus beizubringen, Muster und Zusammenhänge in den Daten zu erkennen. Der Algorithmus passt seine Gewichte anhand der Trainingsdaten an, indem er aus ihnen lernt. Trainingsdaten werden für Klassifikations- und Regressionsprobleme benötigt, bei denen es darum geht, Vorhersagen für bestimmte Zielvariablen zu treffen. Es kann vorkommen, dass Algorithmen, die auf Trainingsdaten lernen, zu sehr auf die Muster in diesen Daten angepasst werden und somit nicht gut auf neue, noch nicht gesehene Daten anwendbar sind. Dies wird als "Überanpassung" oder "Overfitting" bezeichnet. Das bedeutet, dass der Algorithmus zu starke Regeln aus den Trainingsdaten lernt, die auf die Gesamtheit der Daten nicht gut anwendbar sind.</td>
</tr>
<tr>
<td><strong>Validierungsdaten</strong></td>
<td>20%</td>
<td>Der Validierungsdatensatz ist eine Sammlung von Beispieldaten, die verwendet werden, um die Hyperparameter eines Modells anzupassen. Hyperparameter sind Einstellungen, die vor dem Training festgelegt werden und Einfluss auf das Lernverhalten des Modells haben. Beispiele für Hyperparameter bei künstlichen neuronalen Netzen sind die Anzahl der Neuronen in jeder Schicht oder die Lernrate. Durch die Verwendung von Validierungsdaten beim Training kann verhindert werden, dass das Modell zu sehr auf die Trainingsdaten angepasst wird und somit auf neue, noch nicht gesehene Daten nicht gut anwendbar ist.</td>
</tr>
<tr>
<td><strong>Testdaten</strong></td>
<td>10%</td>
<td>Die Testdaten sind von den Trainingsdaten unabhängig und werden während des Trainingsprozesses nicht verwendet. Sie dienen dazu, das trainierte Modell zu bewerten und zu überprüfen, wie gut es auf neue, noch nicht gesehene Daten anwendbar ist. Die Testdaten sollten dieselbe Wahrscheinlichkeitsverteilung wie der Trainingsdatensatz aufweisen. Wenn das Modell gut auf die Testdaten anwendbar ist, kann es vermutlich auch auf andere, bisher ungesehene Daten angewendet werden.</td>
</tr>
</tbody>
</table>
</details>
<p>Um jetzt unseren großen Datensatz <a href="https://github.com/easyh/NerDH/blob/main/data/datensets/taggedData.json" target="blank"><code>taggedData.json</code></a> in zwei Datensets aufzuteilen, lesen wir diesen zunächst ein und speichern nur die Einträge von  <code>annotations</code> in der Variablen <code>TAGGED_DATA</code>, damit wir die Einträge zählen können. Danach ermitteln wir die Grenze (80:20), damit wir den urspünglichen Datensatz in kleinere Datensätze zu je 80% und 20% aufteilen können.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="16:2"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio"/><input id="__tabbed_16_2" name="__tabbed_16" type="radio"/><div class="tabbed-labels"><label for="__tabbed_16_1">Code</label><label for="__tabbed_16_2">Output</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-27-1" id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="kn">import</span> <span class="nn">json</span>
<a href="#__codelineno-27-2" id="__codelineno-27-2" name="__codelineno-27-2"></a>
<a href="#__codelineno-27-3" id="__codelineno-27-3" name="__codelineno-27-3"></a><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'../data/datensets/taggedData.json'</span><span class="p">)</span>
<a href="#__codelineno-27-4" id="__codelineno-27-4" name="__codelineno-27-4"></a><span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a href="#__codelineno-27-5" id="__codelineno-27-5" name="__codelineno-27-5"></a><span class="n">TAGGED_DATA</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'annotations'</span><span class="p">]</span>
<a href="#__codelineno-27-6" id="__codelineno-27-6" name="__codelineno-27-6"></a>
<a href="#__codelineno-27-7" id="__codelineno-27-7" name="__codelineno-27-7"></a><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TAGGED_DATA</span><span class="p">)</span><span class="o">*</span><span class="mf">0.8</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-28-1" id="__codelineno-28-1" name="__codelineno-28-1"></a>696.8000000000001
</code></pre></div>
</div>
</div>
</div>
<p>Bevor wir den Datensatz an der ermittelten Grenzen in die zwei Datensets aufteilen, mischen wir die Einträge noch einmal durch, damit die Verteilung zufällig ist. Hier lassen wir uns dann jeweils die Länge ausgeben, um das Ergebnis zu überprüfen. Zusätzlich lassen wir uns auch noch die Größe des Testdatensatz ausgeben, um zu überprüfen, ob die 70:20:10 Verteilung gewährleistet ist.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="17:2"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio"/><input id="__tabbed_17_2" name="__tabbed_17" type="radio"/><div class="tabbed-labels"><label for="__tabbed_17_1">Code</label><label for="__tabbed_17_2">Output</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-29-1" id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="kn">import</span> <span class="nn">random</span> 
<a href="#__codelineno-29-2" id="__codelineno-29-2" name="__codelineno-29-2"></a>
<a href="#__codelineno-29-3" id="__codelineno-29-3" name="__codelineno-29-3"></a><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">TAGGED_DATA</span><span class="p">)</span>
<a href="#__codelineno-29-4" id="__codelineno-29-4" name="__codelineno-29-4"></a><span class="n">train_data</span> <span class="o">=</span> <span class="n">TAGGED_DATA</span><span class="p">[:</span><span class="mi">697</span><span class="p">]</span>
<a href="#__codelineno-29-5" id="__codelineno-29-5" name="__codelineno-29-5"></a><span class="n">val_data</span> <span class="o">=</span> <span class="n">TAGGED_DATA</span><span class="p">[</span><span class="mi">697</span><span class="p">:]</span>
<a href="#__codelineno-29-6" id="__codelineno-29-6" name="__codelineno-29-6"></a>
<a href="#__codelineno-29-7" id="__codelineno-29-7" name="__codelineno-29-7"></a><span class="nb">print</span><span class="p">(</span><span class="s2">"Traningsdaten: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">)))</span>
<a href="#__codelineno-29-8" id="__codelineno-29-8" name="__codelineno-29-8"></a><span class="nb">print</span><span class="p">(</span><span class="s2">"Validierungsdaten: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">val_data</span><span class="p">)))</span>
<a href="#__codelineno-29-9" id="__codelineno-29-9" name="__codelineno-29-9"></a>
<a href="#__codelineno-29-10" id="__codelineno-29-10" name="__codelineno-29-10"></a><span class="c1">#Zum vergleich, lassen wir uns auch die Göße von unseren Testdaten ausgeben</span>
<a href="#__codelineno-29-11" id="__codelineno-29-11" name="__codelineno-29-11"></a><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'../data/datensets/testData.json'</span><span class="p">)</span>
<a href="#__codelineno-29-12" id="__codelineno-29-12" name="__codelineno-29-12"></a><span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a href="#__codelineno-29-13" id="__codelineno-29-13" name="__codelineno-29-13"></a><span class="n">test_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'annotations'</span><span class="p">]</span>
<a href="#__codelineno-29-14" id="__codelineno-29-14" name="__codelineno-29-14"></a><span class="nb">print</span><span class="p">(</span><span class="s2">"Testdaten: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">)))</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-30-1" id="__codelineno-30-1" name="__codelineno-30-1"></a>Traningsdaten: 697
<a href="#__codelineno-30-2" id="__codelineno-30-2" name="__codelineno-30-2"></a>Validierungsdaten: 174
<a href="#__codelineno-30-3" id="__codelineno-30-3" name="__codelineno-30-3"></a>Testdaten: 87
</code></pre></div>
</div>
</div>
</div>
<p>Anschließend speichern wir die Datensets im <code>JSON</code>-Format ab.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="18:1"><input checked="checked" id="__tabbed_18_1" name="__tabbed_18" type="radio"/><div class="tabbed-labels"><label for="__tabbed_18_1">Code</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-31-1" id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="s1">'../data/datensets/trainData.json'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">train</span><span class="p">:</span> 
<a href="#__codelineno-31-2" id="__codelineno-31-2" name="__codelineno-31-2"></a>    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<a href="#__codelineno-31-3" id="__codelineno-31-3" name="__codelineno-31-3"></a><span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="s1">'../data/datensets/valuationData.json'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">val</span><span class="p">:</span> 
<a href="#__codelineno-31-4" id="__codelineno-31-4" name="__codelineno-31-4"></a>    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">val_data</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p>Da wir weiter oben nur die Einträge aus der Klasse <code>annotations</code> der JSON-Datei übernommen haben, müssen wir jetzt noch einmal manuell bei <code>trainData.json</code> sowie <code>validationData.json</code> die <code>classes</code> hinzufügen, damit unsere Kategorien für die Entitäten nicht verloren gehen. Dazu setzen wir an den Anfang des Dokuments folgendes und ans Ende eine <code>}</code> um das Dokument zu schließen.</p>
<p><div class="highlight"><pre><span></span><code><a href="#__codelineno-32-1" id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="p">{</span><span class="nt">"classes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"PERSON"</span><span class="p">,</span><span class="s2">"ORT"</span><span class="p">,</span><span class="w"> </span><span class="s2">"ORGANISATION"</span><span class="p">,</span><span class="s2">"OBJEKT"</span><span class="p">,</span><span class="s2">"ZEIT"</span><span class="p">],</span><span class="w"></span>
<a href="#__codelineno-32-2" id="__codelineno-32-2" name="__codelineno-32-2"></a><span class="w">    </span><span class="nt">"annotations"</span><span class="p">:</span><span class="w"> </span>
</code></pre></div>
Jetzt müssen die Datensets im <code>JSON</code>-Format nur noch ins <code>spaCy</code>-Format konvertiert werden. Dafür importieren wir zunächst die ensprechenden Bibliotheken und das mittlere Sprachmodell von <code>spaCy</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="19:1"><input checked="checked" id="__tabbed_19_1" name="__tabbed_19" type="radio"/><div class="tabbed-labels"><label for="__tabbed_19_1">Code</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-33-1" id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="kn">import</span> <span class="nn">spacy</span>
<a href="#__codelineno-33-2" id="__codelineno-33-2" name="__codelineno-33-2"></a><span class="kn">from</span> <span class="nn">spacy.tokens</span> <span class="kn">import</span> <span class="n">DocBin</span>
<a href="#__codelineno-33-3" id="__codelineno-33-3" name="__codelineno-33-3"></a><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<a href="#__codelineno-33-4" id="__codelineno-33-4" name="__codelineno-33-4"></a>
<a href="#__codelineno-33-5" id="__codelineno-33-5" name="__codelineno-33-5"></a><span class="c1">#neues spacy Model laden</span>
<a href="#__codelineno-33-6" id="__codelineno-33-6" name="__codelineno-33-6"></a><span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">"de_core_news_md"</span><span class="p">)</span> 
<a href="#__codelineno-33-7" id="__codelineno-33-7" name="__codelineno-33-7"></a>
<a href="#__codelineno-33-8" id="__codelineno-33-8" name="__codelineno-33-8"></a><span class="c1">#DocBin Objekt erstellen</span>
<a href="#__codelineno-33-9" id="__codelineno-33-9" name="__codelineno-33-9"></a><span class="n">db</span> <span class="o">=</span> <span class="n">DocBin</span><span class="p">()</span> 
</code></pre></div>
</div>
</div>
</div>
<p>Jetzt müssen wir für jedes Datenset nur noch folgenden Code ausführen, damit die Datensets im <code>spaCy</code>-Datenformat sind. 
Der Code ist von <a href="https://web.archive.org/web/20230119162746/https://towardsdatascience.com/using-spacy-3-0-to-build-a-custom-ner-model-c9256bea098?gi=fa93a146dfd7" target="blank">hier</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="20:3"><input checked="checked" id="__tabbed_20_1" name="__tabbed_20" type="radio"/><input id="__tabbed_20_2" name="__tabbed_20" type="radio"/><input id="__tabbed_20_3" name="__tabbed_20" type="radio"/><div class="tabbed-labels"><label for="__tabbed_20_1">Traningsdaten</label><label for="__tabbed_20_2">Validierungsdaten</label><label for="__tabbed_20_3">Testdaten</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-34-1" id="__codelineno-34-1" name="__codelineno-34-1"></a><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'../data/datensets/trainData.json'</span><span class="p">)</span>
<a href="#__codelineno-34-2" id="__codelineno-34-2" name="__codelineno-34-2"></a><span class="n">TRAIN_DATA</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a href="#__codelineno-34-3" id="__codelineno-34-3" name="__codelineno-34-3"></a>
<a href="#__codelineno-34-4" id="__codelineno-34-4" name="__codelineno-34-4"></a><span class="k">for</span> <span class="n">text</span><span class="p">,</span> <span class="n">annot</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">TRAIN_DATA</span><span class="p">[</span><span class="s1">'annotations'</span><span class="p">]):</span> 
<a href="#__codelineno-34-5" id="__codelineno-34-5" name="__codelineno-34-5"></a><span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="o">.</span><span class="n">make_doc</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> 
<a href="#__codelineno-34-6" id="__codelineno-34-6" name="__codelineno-34-6"></a><span class="n">ents</span> <span class="o">=</span> <span class="p">[]</span>
<a href="#__codelineno-34-7" id="__codelineno-34-7" name="__codelineno-34-7"></a><span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">annot</span><span class="p">[</span><span class="s2">"entities"</span><span class="p">]:</span>
<a href="#__codelineno-34-8" id="__codelineno-34-8" name="__codelineno-34-8"></a>    <span class="n">span</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">char_span</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">alignment_mode</span><span class="o">=</span><span class="s2">"contract"</span><span class="p">)</span>
<a href="#__codelineno-34-9" id="__codelineno-34-9" name="__codelineno-34-9"></a>    <span class="k">if</span> <span class="n">span</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a href="#__codelineno-34-10" id="__codelineno-34-10" name="__codelineno-34-10"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">"Skipping entity"</span><span class="p">)</span>
<a href="#__codelineno-34-11" id="__codelineno-34-11" name="__codelineno-34-11"></a>    <span class="k">else</span><span class="p">:</span>
<a href="#__codelineno-34-12" id="__codelineno-34-12" name="__codelineno-34-12"></a>        <span class="n">ents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>
<a href="#__codelineno-34-13" id="__codelineno-34-13" name="__codelineno-34-13"></a><span class="n">doc</span><span class="o">.</span><span class="n">ents</span> <span class="o">=</span> <span class="n">ents</span> 
<a href="#__codelineno-34-14" id="__codelineno-34-14" name="__codelineno-34-14"></a><span class="n">db</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
<a href="#__codelineno-34-15" id="__codelineno-34-15" name="__codelineno-34-15"></a>
<a href="#__codelineno-34-16" id="__codelineno-34-16" name="__codelineno-34-16"></a><span class="c1">#Docbin Objekt speichern</span>
<a href="#__codelineno-34-17" id="__codelineno-34-17" name="__codelineno-34-17"></a><span class="n">db</span><span class="o">.</span><span class="n">to_disk</span><span class="p">(</span><span class="s2">"../data/datasets/trainData.spacy"</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-35-1" id="__codelineno-35-1" name="__codelineno-35-1"></a><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'../data/datensets/valuationData.json'</span><span class="p">)</span>
<a href="#__codelineno-35-2" id="__codelineno-35-2" name="__codelineno-35-2"></a><span class="n">VAL_DATA</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a href="#__codelineno-35-3" id="__codelineno-35-3" name="__codelineno-35-3"></a>
<a href="#__codelineno-35-4" id="__codelineno-35-4" name="__codelineno-35-4"></a><span class="k">for</span> <span class="n">text</span><span class="p">,</span> <span class="n">annot</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">VAL_DATA</span><span class="p">[</span><span class="s1">'annotations'</span><span class="p">]):</span> 
<a href="#__codelineno-35-5" id="__codelineno-35-5" name="__codelineno-35-5"></a><span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="o">.</span><span class="n">make_doc</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> 
<a href="#__codelineno-35-6" id="__codelineno-35-6" name="__codelineno-35-6"></a><span class="n">ents</span> <span class="o">=</span> <span class="p">[]</span>
<a href="#__codelineno-35-7" id="__codelineno-35-7" name="__codelineno-35-7"></a><span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">annot</span><span class="p">[</span><span class="s2">"entities"</span><span class="p">]:</span>
<a href="#__codelineno-35-8" id="__codelineno-35-8" name="__codelineno-35-8"></a>    <span class="n">span</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">char_span</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">alignment_mode</span><span class="o">=</span><span class="s2">"contract"</span><span class="p">)</span>
<a href="#__codelineno-35-9" id="__codelineno-35-9" name="__codelineno-35-9"></a>    <span class="k">if</span> <span class="n">span</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a href="#__codelineno-35-10" id="__codelineno-35-10" name="__codelineno-35-10"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">"Skipping entity"</span><span class="p">)</span>
<a href="#__codelineno-35-11" id="__codelineno-35-11" name="__codelineno-35-11"></a>    <span class="k">else</span><span class="p">:</span>
<a href="#__codelineno-35-12" id="__codelineno-35-12" name="__codelineno-35-12"></a>        <span class="n">ents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>
<a href="#__codelineno-35-13" id="__codelineno-35-13" name="__codelineno-35-13"></a><span class="n">doc</span><span class="o">.</span><span class="n">ents</span> <span class="o">=</span> <span class="n">ents</span> 
<a href="#__codelineno-35-14" id="__codelineno-35-14" name="__codelineno-35-14"></a><span class="n">db</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
<a href="#__codelineno-35-15" id="__codelineno-35-15" name="__codelineno-35-15"></a>
<a href="#__codelineno-35-16" id="__codelineno-35-16" name="__codelineno-35-16"></a><span class="c1">#Docbin Objekt speichern</span>
<a href="#__codelineno-35-17" id="__codelineno-35-17" name="__codelineno-35-17"></a><span class="n">db</span><span class="o">.</span><span class="n">to_disk</span><span class="p">(</span><span class="s2">"../data/datasets/valuationData.spacy"</span><span class="p">)</span> 
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a href="#__codelineno-36-1" id="__codelineno-36-1" name="__codelineno-36-1"></a><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'../data/datensets/testData.json'</span><span class="p">)</span>
<a href="#__codelineno-36-2" id="__codelineno-36-2" name="__codelineno-36-2"></a><span class="n">TEST_DATA</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a href="#__codelineno-36-3" id="__codelineno-36-3" name="__codelineno-36-3"></a>
<a href="#__codelineno-36-4" id="__codelineno-36-4" name="__codelineno-36-4"></a><span class="k">for</span> <span class="n">text</span><span class="p">,</span> <span class="n">annot</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">TEST_DATA</span><span class="p">[</span><span class="s1">'annotations'</span><span class="p">]):</span> 
<a href="#__codelineno-36-5" id="__codelineno-36-5" name="__codelineno-36-5"></a><span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="o">.</span><span class="n">make_doc</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> 
<a href="#__codelineno-36-6" id="__codelineno-36-6" name="__codelineno-36-6"></a><span class="n">ents</span> <span class="o">=</span> <span class="p">[]</span>
<a href="#__codelineno-36-7" id="__codelineno-36-7" name="__codelineno-36-7"></a><span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">annot</span><span class="p">[</span><span class="s2">"entities"</span><span class="p">]:</span>
<a href="#__codelineno-36-8" id="__codelineno-36-8" name="__codelineno-36-8"></a>    <span class="n">span</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">char_span</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">alignment_mode</span><span class="o">=</span><span class="s2">"contract"</span><span class="p">)</span>
<a href="#__codelineno-36-9" id="__codelineno-36-9" name="__codelineno-36-9"></a>    <span class="k">if</span> <span class="n">span</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a href="#__codelineno-36-10" id="__codelineno-36-10" name="__codelineno-36-10"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">"Skipping entity"</span><span class="p">)</span>
<a href="#__codelineno-36-11" id="__codelineno-36-11" name="__codelineno-36-11"></a>    <span class="k">else</span><span class="p">:</span>
<a href="#__codelineno-36-12" id="__codelineno-36-12" name="__codelineno-36-12"></a>        <span class="n">ents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>
<a href="#__codelineno-36-13" id="__codelineno-36-13" name="__codelineno-36-13"></a><span class="n">doc</span><span class="o">.</span><span class="n">ents</span> <span class="o">=</span> <span class="n">ents</span> 
<a href="#__codelineno-36-14" id="__codelineno-36-14" name="__codelineno-36-14"></a><span class="n">db</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
<a href="#__codelineno-36-15" id="__codelineno-36-15" name="__codelineno-36-15"></a>
<a href="#__codelineno-36-16" id="__codelineno-36-16" name="__codelineno-36-16"></a><span class="c1">#Docbin Objekt speichern</span>
<a href="#__codelineno-36-17" id="__codelineno-36-17" name="__codelineno-36-17"></a><span class="n">db</span><span class="o">.</span><span class="n">to_disk</span><span class="p">(</span><span class="s2">"../data/datasets/testData.spacy"</span><span class="p">)</span> 
</code></pre></div>
</div>
</div>
</div>
<p>Damit ist das Preprocessing abgeschlossen und wir können mit dem Training des Modells beginnen.</p>
<p><br/></p>
<div class="admonition int">
<p class="admonition-title">Jupyter Notebooks</p>
<p>Der Code zu diesem Kapitel befindet sich hier: <code>notebooks/03_createDatasets_spacy.ipynb</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="21:2"><input checked="checked" id="__tabbed_21_1" name="__tabbed_21" type="radio"/><input id="__tabbed_21_2" name="__tabbed_21" type="radio"/><div class="tabbed-labels"><label for="__tabbed_21_1"><span class="twemoji"><svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></span> Github</label><label for="__tabbed_21_2"><span class="twemoji"><svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M64 96c0-35.3 28.7-64 64-64h384c35.3 0 64 28.7 64 64v256h-64V96H128v256H64V96zM0 403.2C0 392.6 8.6 384 19.2 384h601.6c10.6 0 19.2 8.6 19.2 19.2 0 42.4-34.4 76.8-76.8 76.8H76.8C34.4 480 0 445.6 0 403.2zM281 209l-31 31 31 31c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-48-48c-9.4-9.4-9.4-24.6 0-33.9l48-48c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9zm112-34 48 48c9.4 9.4 9.4 24.6 0 33.9l-48 48c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l31-31-31-31c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0z"></path></svg></span> mybinder.org</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><a class="md-button" href="https://github.com/easyh/NerDH/blob/main/notebooks/03_createDatasets_spacy.ipynb" target="blank">Hier geht es zum Notebook auf Github</a></p>
</div>
<div class="tabbed-block">
<p><a class="md-button" href="https://mybinder.org/v2/gh/easyh/NerDH/HEAD" target="blank">Hier geht es zum Jupyter Notebook auf mybinder.org</a></p>
<p><strong>Das Laden des Workspaces wird einen kurzen Moment in Anspruch nehmen.</strong></p>
</div>
</div>
</div>
</div>
<p><br/></p>
<h3 id="33-training"><strong>3.3 Training</strong></h3>
<p>Da wir jetzt alle unsere Daten haben, ist es an der Zeit unser  Modell zu trainieren. In <code>spaCy</code> können wir die Architektur unseres Netzes sowie die Hyperparamter für unser Modell weitgehend steuern. Dies geschieht in der <code>config.cfg</code> Datei. Diese Konfigurationsdatei wird <code>spaCy</code> während dem Trainingsprozess übergeben, damit das System weiß, was und wie es trainieren soll. Um die <code>config.cfg</code> Datei zu erstellen, können wir die <a href="https://spacy.io/usage/training#quickstart" target="blank">praktische GUI von <code>spaCy</code></a> selbst benutzen.</p>
<p>Für unsere Zwecke wählen wir <code>German</code>, <code>ner</code> und <code>CPU</code>(GPU ist etwas komplexer). Jenachdem ob wir ohne Wortvektoren oder mit ihnen trainieren wollen, wählen wir <code>efficiency</code> oder <code>accuracy</code>. In unserem Beispiel haben wir mit <code>accuracy</code>, also mit Wortvektoren trainiert. Hier werden dann die Vektoren des großen deutschen Modell <code>de_core_news_lg</code> übernommen (das können wir natürlich auch mit dem kleinen bzw. mittleren Modell machen). Diese Datei speichern wir zunächst als <code>base_config.cfg</code> ab. Die <code>base_config.cfg</code>-Datei befindet sich ebenfalls auf Github im Ordner <code>notebooks</code> oder kann hier einfach kopiert werden. </p>
<details class="code"><summary><code>base_config.cfg</code></summary><div class="highlight"><pre><span></span><code><a href="#__codelineno-37-1" id="__codelineno-37-1" name="__codelineno-37-1"></a><span class="k">[paths]</span><span class="w"></span>
<a href="#__codelineno-37-2" id="__codelineno-37-2" name="__codelineno-37-2"></a><span class="na">train</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">null</span><span class="w"></span>
<a href="#__codelineno-37-3" id="__codelineno-37-3" name="__codelineno-37-3"></a><span class="na">dev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">null</span><span class="w"></span>
<a href="#__codelineno-37-4" id="__codelineno-37-4" name="__codelineno-37-4"></a><span class="na">vectors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"de_core_news_lg"</span><span class="w"></span>
<a href="#__codelineno-37-5" id="__codelineno-37-5" name="__codelineno-37-5"></a><span class="k">[system]</span><span class="w"></span>
<a href="#__codelineno-37-6" id="__codelineno-37-6" name="__codelineno-37-6"></a><span class="na">gpu_allocator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">null</span><span class="w"></span>
<a href="#__codelineno-37-7" id="__codelineno-37-7" name="__codelineno-37-7"></a>
<a href="#__codelineno-37-8" id="__codelineno-37-8" name="__codelineno-37-8"></a><span class="k">[nlp]</span><span class="w"></span>
<a href="#__codelineno-37-9" id="__codelineno-37-9" name="__codelineno-37-9"></a><span class="na">lang</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"de"</span><span class="w"></span>
<a href="#__codelineno-37-10" id="__codelineno-37-10" name="__codelineno-37-10"></a><span class="na">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">["tok2vec","ner"]</span><span class="w"></span>
<a href="#__codelineno-37-11" id="__codelineno-37-11" name="__codelineno-37-11"></a><span class="na">batch_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1000</span><span class="w"></span>
<a href="#__codelineno-37-12" id="__codelineno-37-12" name="__codelineno-37-12"></a>
<a href="#__codelineno-37-13" id="__codelineno-37-13" name="__codelineno-37-13"></a><span class="k">[components]</span><span class="w"></span>
<a href="#__codelineno-37-14" id="__codelineno-37-14" name="__codelineno-37-14"></a>
<a href="#__codelineno-37-15" id="__codelineno-37-15" name="__codelineno-37-15"></a><span class="k">[components.tok2vec]</span><span class="w"></span>
<a href="#__codelineno-37-16" id="__codelineno-37-16" name="__codelineno-37-16"></a><span class="na">factory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"tok2vec"</span><span class="w"></span>
<a href="#__codelineno-37-17" id="__codelineno-37-17" name="__codelineno-37-17"></a>
<a href="#__codelineno-37-18" id="__codelineno-37-18" name="__codelineno-37-18"></a><span class="k">[components.tok2vec.model]</span><span class="w"></span>
<a href="#__codelineno-37-19" id="__codelineno-37-19" name="__codelineno-37-19"></a><span class="na">@architectures</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"spacy.Tok2Vec.v2"</span><span class="w"></span>
<a href="#__codelineno-37-20" id="__codelineno-37-20" name="__codelineno-37-20"></a>
<a href="#__codelineno-37-21" id="__codelineno-37-21" name="__codelineno-37-21"></a><span class="k">[components.tok2vec.model.embed]</span><span class="w"></span>
<a href="#__codelineno-37-22" id="__codelineno-37-22" name="__codelineno-37-22"></a><span class="na">@architectures</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"spacy.MultiHashEmbed.v2"</span><span class="w"></span>
<a href="#__codelineno-37-23" id="__codelineno-37-23" name="__codelineno-37-23"></a><span class="na">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">${components.tok2vec.model.encode.width}</span><span class="w"></span>
<a href="#__codelineno-37-24" id="__codelineno-37-24" name="__codelineno-37-24"></a><span class="na">attrs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">["NORM", "PREFIX", "SUFFIX", "SHAPE"]</span><span class="w"></span>
<a href="#__codelineno-37-25" id="__codelineno-37-25" name="__codelineno-37-25"></a><span class="na">rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">[5000, 1000, 2500, 2500]</span><span class="w"></span>
<a href="#__codelineno-37-26" id="__codelineno-37-26" name="__codelineno-37-26"></a><span class="na">include_static_vectors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span><span class="w"></span>
<a href="#__codelineno-37-27" id="__codelineno-37-27" name="__codelineno-37-27"></a>
<a href="#__codelineno-37-28" id="__codelineno-37-28" name="__codelineno-37-28"></a><span class="k">[components.tok2vec.model.encode]</span><span class="w"></span>
<a href="#__codelineno-37-29" id="__codelineno-37-29" name="__codelineno-37-29"></a><span class="na">@architectures</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"spacy.MaxoutWindowEncoder.v2"</span><span class="w"></span>
<a href="#__codelineno-37-30" id="__codelineno-37-30" name="__codelineno-37-30"></a><span class="na">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">256</span><span class="w"></span>
<a href="#__codelineno-37-31" id="__codelineno-37-31" name="__codelineno-37-31"></a><span class="na">depth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">8</span><span class="w"></span>
<a href="#__codelineno-37-32" id="__codelineno-37-32" name="__codelineno-37-32"></a><span class="na">window_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span><span class="w"></span>
<a href="#__codelineno-37-33" id="__codelineno-37-33" name="__codelineno-37-33"></a><span class="na">maxout_pieces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">3</span><span class="w"></span>
<a href="#__codelineno-37-34" id="__codelineno-37-34" name="__codelineno-37-34"></a>
<a href="#__codelineno-37-35" id="__codelineno-37-35" name="__codelineno-37-35"></a><span class="k">[components.ner]</span><span class="w"></span>
<a href="#__codelineno-37-36" id="__codelineno-37-36" name="__codelineno-37-36"></a><span class="na">factory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"ner"</span><span class="w"></span>
<a href="#__codelineno-37-37" id="__codelineno-37-37" name="__codelineno-37-37"></a>
<a href="#__codelineno-37-38" id="__codelineno-37-38" name="__codelineno-37-38"></a><span class="k">[components.ner.model]</span><span class="w"></span>
<a href="#__codelineno-37-39" id="__codelineno-37-39" name="__codelineno-37-39"></a><span class="na">@architectures</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"spacy.TransitionBasedParser.v2"</span><span class="w"></span>
<a href="#__codelineno-37-40" id="__codelineno-37-40" name="__codelineno-37-40"></a><span class="na">state_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"ner"</span><span class="w"></span>
<a href="#__codelineno-37-41" id="__codelineno-37-41" name="__codelineno-37-41"></a><span class="na">extra_state_tokens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span><span class="w"></span>
<a href="#__codelineno-37-42" id="__codelineno-37-42" name="__codelineno-37-42"></a><span class="na">hidden_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">64</span><span class="w"></span>
<a href="#__codelineno-37-43" id="__codelineno-37-43" name="__codelineno-37-43"></a><span class="na">maxout_pieces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">2</span><span class="w"></span>
<a href="#__codelineno-37-44" id="__codelineno-37-44" name="__codelineno-37-44"></a><span class="na">use_upper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span><span class="w"></span>
<a href="#__codelineno-37-45" id="__codelineno-37-45" name="__codelineno-37-45"></a><span class="na">nO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">null</span><span class="w"></span>
<a href="#__codelineno-37-46" id="__codelineno-37-46" name="__codelineno-37-46"></a>
<a href="#__codelineno-37-47" id="__codelineno-37-47" name="__codelineno-37-47"></a><span class="k">[components.ner.model.tok2vec]</span><span class="w"></span>
<a href="#__codelineno-37-48" id="__codelineno-37-48" name="__codelineno-37-48"></a><span class="na">@architectures</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"spacy.Tok2VecListener.v1"</span><span class="w"></span>
<a href="#__codelineno-37-49" id="__codelineno-37-49" name="__codelineno-37-49"></a><span class="na">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">${components.tok2vec.model.encode.width}</span><span class="w"></span>
<a href="#__codelineno-37-50" id="__codelineno-37-50" name="__codelineno-37-50"></a>
<a href="#__codelineno-37-51" id="__codelineno-37-51" name="__codelineno-37-51"></a><span class="k">[corpora]</span><span class="w"></span>
<a href="#__codelineno-37-52" id="__codelineno-37-52" name="__codelineno-37-52"></a>
<a href="#__codelineno-37-53" id="__codelineno-37-53" name="__codelineno-37-53"></a><span class="k">[corpora.train]</span><span class="w"></span>
<a href="#__codelineno-37-54" id="__codelineno-37-54" name="__codelineno-37-54"></a><span class="na">@readers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"spacy.Corpus.v1"</span><span class="w"></span>
<a href="#__codelineno-37-55" id="__codelineno-37-55" name="__codelineno-37-55"></a><span class="na">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">${paths.train}</span><span class="w"></span>
<a href="#__codelineno-37-56" id="__codelineno-37-56" name="__codelineno-37-56"></a><span class="na">max_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0</span><span class="w"></span>
<a href="#__codelineno-37-57" id="__codelineno-37-57" name="__codelineno-37-57"></a>
<a href="#__codelineno-37-58" id="__codelineno-37-58" name="__codelineno-37-58"></a><span class="k">[corpora.dev]</span><span class="w"></span>
<a href="#__codelineno-37-59" id="__codelineno-37-59" name="__codelineno-37-59"></a><span class="na">@readers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"spacy.Corpus.v1"</span><span class="w"></span>
<a href="#__codelineno-37-60" id="__codelineno-37-60" name="__codelineno-37-60"></a><span class="na">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">${paths.dev}</span><span class="w"></span>
<a href="#__codelineno-37-61" id="__codelineno-37-61" name="__codelineno-37-61"></a><span class="na">max_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0</span><span class="w"></span>
<a href="#__codelineno-37-62" id="__codelineno-37-62" name="__codelineno-37-62"></a>
<a href="#__codelineno-37-63" id="__codelineno-37-63" name="__codelineno-37-63"></a><span class="k">[training]</span><span class="w"></span>
<a href="#__codelineno-37-64" id="__codelineno-37-64" name="__codelineno-37-64"></a><span class="na">dev_corpus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"corpora.dev"</span><span class="w"></span>
<a href="#__codelineno-37-65" id="__codelineno-37-65" name="__codelineno-37-65"></a><span class="na">train_corpus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"corpora.train"</span><span class="w"></span>
<a href="#__codelineno-37-66" id="__codelineno-37-66" name="__codelineno-37-66"></a>
<a href="#__codelineno-37-67" id="__codelineno-37-67" name="__codelineno-37-67"></a><span class="k">[training.optimizer]</span><span class="w"></span>
<a href="#__codelineno-37-68" id="__codelineno-37-68" name="__codelineno-37-68"></a><span class="na">@optimizers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Adam.v1"</span><span class="w"></span>
<a href="#__codelineno-37-69" id="__codelineno-37-69" name="__codelineno-37-69"></a>
<a href="#__codelineno-37-70" id="__codelineno-37-70" name="__codelineno-37-70"></a><span class="k">[training.batcher]</span><span class="w"></span>
<a href="#__codelineno-37-71" id="__codelineno-37-71" name="__codelineno-37-71"></a><span class="na">@batchers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"spacy.batch_by_words.v1"</span><span class="w"></span>
<a href="#__codelineno-37-72" id="__codelineno-37-72" name="__codelineno-37-72"></a><span class="na">discard_oversize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span><span class="w"></span>
<a href="#__codelineno-37-73" id="__codelineno-37-73" name="__codelineno-37-73"></a><span class="na">tolerance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.2</span><span class="w"></span>
<a href="#__codelineno-37-74" id="__codelineno-37-74" name="__codelineno-37-74"></a>
<a href="#__codelineno-37-75" id="__codelineno-37-75" name="__codelineno-37-75"></a><span class="k">[training.batcher.size]</span><span class="w"></span>
<a href="#__codelineno-37-76" id="__codelineno-37-76" name="__codelineno-37-76"></a><span class="na">@schedules</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"compounding.v1"</span><span class="w"></span>
<a href="#__codelineno-37-77" id="__codelineno-37-77" name="__codelineno-37-77"></a><span class="na">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">100</span><span class="w"></span>
<a href="#__codelineno-37-78" id="__codelineno-37-78" name="__codelineno-37-78"></a><span class="na">stop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1000</span><span class="w"></span>
<a href="#__codelineno-37-79" id="__codelineno-37-79" name="__codelineno-37-79"></a><span class="na">compound</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1.001</span><span class="w"></span>
<a href="#__codelineno-37-80" id="__codelineno-37-80" name="__codelineno-37-80"></a>
<a href="#__codelineno-37-81" id="__codelineno-37-81" name="__codelineno-37-81"></a><span class="k">[initialize]</span><span class="w"></span>
<a href="#__codelineno-37-82" id="__codelineno-37-82" name="__codelineno-37-82"></a><span class="na">vectors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">${paths.vectors}</span><span class="w"></span>
</code></pre></div>
</details>
<p>Da die <code>base_config.cfg</code>-Datei nun korrekt eingerichtet ist, müssen wir sie in eine <code>config.cfg</code>-Datei umwandeln. Dazu müssen wir einen Terminalbefehl ausführen. Durch Ausführen des folgenden Befehls erhalten wir die korrekt formatierte <code>config.cfg</code>-Datei.</p>
<p><div class="highlight"><pre><span></span><code><a href="#__codelineno-38-1" id="__codelineno-38-1" name="__codelineno-38-1"></a>python -m spacy init fill-config ./base_config.cfg ./config.cfg
</code></pre></div>
Jetzt haben wir alles, um unser erstes Modell zu trainieren. Wir erstellen einen Ordner namens <code>output</code>, hier wird unser fertiges Modell dann abgelegt. Wir müssen nur den folgenden Befehl ausführen, etwas warten und schon haben wir ein trainiertes Modell.  Hinter <code>paths.train</code> setzen wir den Pfad zu unseren Trainingsdaten und hinter <code>paths.dev</code> unsere Valuierungsdaten</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-39-1" id="__codelineno-39-1" name="__codelineno-39-1"></a>python -m spacy train config.cfg --output ./output --paths.train ./datensets/trainData.spacy --paths.dev ./datensets/valuationData.spacy
</code></pre></div>
<details class="code"><summary>Trainingsausgabe</summary><p>Die Ausgabe zeigt uns die Epochen, die Anzahl der Stichproben sowie einige Metriken für unser Modell. </p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-40-1" id="__codelineno-40-1" name="__codelineno-40-1"></a>ℹ Saving to output directory: output
<a href="#__codelineno-40-2" id="__codelineno-40-2" name="__codelineno-40-2"></a>ℹ Using CPU
<a href="#__codelineno-40-3" id="__codelineno-40-3" name="__codelineno-40-3"></a>
<a href="#__codelineno-40-4" id="__codelineno-40-4" name="__codelineno-40-4"></a>=========================== Initializing pipeline ===========================
<a href="#__codelineno-40-5" id="__codelineno-40-5" name="__codelineno-40-5"></a>[2022-11-19 13:23:54,923] [INFO] Set up nlp object from config
<a href="#__codelineno-40-6" id="__codelineno-40-6" name="__codelineno-40-6"></a>[2022-11-19 13:23:54,941] [INFO] Pipeline: ['tok2vec', 'ner']
<a href="#__codelineno-40-7" id="__codelineno-40-7" name="__codelineno-40-7"></a>[2022-11-19 13:23:54,949] [INFO] Created vocabulary
<a href="#__codelineno-40-8" id="__codelineno-40-8" name="__codelineno-40-8"></a>[2022-11-19 13:24:00,463] [INFO] Added vectors: de_core_news_lg
<a href="#__codelineno-40-9" id="__codelineno-40-9" name="__codelineno-40-9"></a>[2022-11-19 13:24:06,491] [INFO] Finished initializing nlp object
<a href="#__codelineno-40-10" id="__codelineno-40-10" name="__codelineno-40-10"></a>[2022-11-19 13:24:09,274] [INFO] Initialized pipeline components: ['tok2vec', 'ner']
<a href="#__codelineno-40-11" id="__codelineno-40-11" name="__codelineno-40-11"></a>✔ Initialized pipeline
<a href="#__codelineno-40-12" id="__codelineno-40-12" name="__codelineno-40-12"></a>
<a href="#__codelineno-40-13" id="__codelineno-40-13" name="__codelineno-40-13"></a>============================= Training pipeline =============================
<a href="#__codelineno-40-14" id="__codelineno-40-14" name="__codelineno-40-14"></a>ℹ Pipeline: ['tok2vec', 'ner']
<a href="#__codelineno-40-15" id="__codelineno-40-15" name="__codelineno-40-15"></a>ℹ Initial learn rate: 0.001
<a href="#__codelineno-40-16" id="__codelineno-40-16" name="__codelineno-40-16"></a>E    #       LOSS TOK2VEC  LOSS NER  ENTS_F  ENTS_P  ENTS_R  SCORE 
<a href="#__codelineno-40-17" id="__codelineno-40-17" name="__codelineno-40-17"></a>---  ------  ------------  --------  ------  ------  ------  ------
<a href="#__codelineno-40-18" id="__codelineno-40-18" name="__codelineno-40-18"></a>0       0          0.00     85.09    0.00    0.00    0.00    0.00
<a href="#__codelineno-40-19" id="__codelineno-40-19" name="__codelineno-40-19"></a>0     200        880.61   2879.21   55.96   75.37   44.50    0.56
<a href="#__codelineno-40-20" id="__codelineno-40-20" name="__codelineno-40-20"></a>1     400         65.55   1510.84   71.81   67.93   76.15    0.72
<a href="#__codelineno-40-21" id="__codelineno-40-21" name="__codelineno-40-21"></a>2     600        109.01   1268.59   82.27   81.65   82.89    0.82
<a href="#__codelineno-40-22" id="__codelineno-40-22" name="__codelineno-40-22"></a>4     800         78.71    901.58   86.86   87.08   86.64    0.87
<a href="#__codelineno-40-23" id="__codelineno-40-23" name="__codelineno-40-23"></a>5    1000         74.96    737.24   88.99   91.39   86.73    0.89
<a href="#__codelineno-40-24" id="__codelineno-40-24" name="__codelineno-40-24"></a>7    1200         80.31    559.43   90.62   91.06   90.18    0.91
<a href="#__codelineno-40-25" id="__codelineno-40-25" name="__codelineno-40-25"></a>show more (open the raw output data in a text editor) ...
<a href="#__codelineno-40-26" id="__codelineno-40-26" name="__codelineno-40-26"></a>
<a href="#__codelineno-40-27" id="__codelineno-40-27" name="__codelineno-40-27"></a>143    5200        180.50     58.97   93.98   93.86   94.10    0.94
<a href="#__codelineno-40-28" id="__codelineno-40-28" name="__codelineno-40-28"></a>151    5400        211.91     75.53   93.96   93.79   94.14    0.94
<a href="#__codelineno-40-29" id="__codelineno-40-29" name="__codelineno-40-29"></a>159    5600        376.93    128.75   94.00   93.98   94.02    0.94
<a href="#__codelineno-40-30" id="__codelineno-40-30" name="__codelineno-40-30"></a>✔ Saved pipeline to output directory
<a href="#__codelineno-40-31" id="__codelineno-40-31" name="__codelineno-40-31"></a>output/model-last
</code></pre></div>
</details>
<p>In unserem <code>output</code>-Ordner befinden sich nun zwei Unterordner: <code>model-best</code>und <code>model-last</code>. Beide dieser Modelle können jetzt in der <code>spacy.load()</code> Funktion eingelesen und ausprobiert werden. Hier wird dann einfach der Pfad angegeben, wo das Modell liegt. </p>
<p><div class="highlight"><pre><span></span><code><a href="#__codelineno-41-1" id="__codelineno-41-1" name="__codelineno-41-1"></a><span class="kn">import</span> <span class="nn">spacy</span> 
<a href="#__codelineno-41-2" id="__codelineno-41-2" name="__codelineno-41-2"></a>
<a href="#__codelineno-41-3" id="__codelineno-41-3" name="__codelineno-41-3"></a><span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">output</span><span class="o">/</span><span class="n">model</span><span class="o">-</span><span class="n">best</span><span class="p">)</span>
</code></pre></div>
Im Github Repositry gibt es keinen <code>output</code>-Ordner mit einem Modell, da das trainierte Modell zu groß ist. Allerdings gibt es von <code>spaCy</code> die Möglichkeit ein Modell in ein Python Package zu packen, dass dann wie jedes andere Package mit <code>pip install</code>installiert werden kann. </p>
<details class="note"><summary>Modell als Python Package verpacken</summary><p>Dafür müssen wir uns einmal in das Innere unseres Modells klicken und in der <code>meta.json</code>-Datei noch kleine Änderungen vornehmen.  Bei <code>name</code> vergeben wir dem Modell einen Namen, mit dem wir es laden möchten. Zusätzlich geben wir noch eine <code>version</code> an: Da es unser erstes Modell ist setzen wir die Version auf <code>0.0.1</code>. Natürlich können wir hier auch noch mehr Informationen wie z.B. <code>description</code>, <code>author</code> oder <code>email</code>angeben. </p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-42-1" id="__codelineno-42-1" name="__codelineno-42-1"></a><span class="p">{</span><span class="w"></span>
<a href="#__codelineno-42-2" id="__codelineno-42-2" name="__codelineno-42-2"></a><span class="nt">"lang"</span><span class="p">:</span><span class="s2">"de"</span><span class="p">,</span><span class="w"></span>
<a href="#__codelineno-42-3" id="__codelineno-42-3" name="__codelineno-42-3"></a><span class="nt">"name"</span><span class="p">:</span><span class="s2">"de_fnhd_nerdh"</span><span class="p">,</span><span class="w"></span>
<a href="#__codelineno-42-4" id="__codelineno-42-4" name="__codelineno-42-4"></a><span class="nt">"version"</span><span class="p">:</span><span class="s2">"0.0.1"</span><span class="p">,</span><span class="w"></span>
<a href="#__codelineno-42-5" id="__codelineno-42-5" name="__codelineno-42-5"></a><span class="nt">"spacy_version"</span><span class="p">:</span><span class="s2">"&gt;=3.4.1,&lt;3.5.0"</span><span class="p">,</span><span class="w"></span>
<a href="#__codelineno-42-6" id="__codelineno-42-6" name="__codelineno-42-6"></a><span class="nt">"description"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w"></span>
<a href="#__codelineno-42-7" id="__codelineno-42-7" name="__codelineno-42-7"></a><span class="nt">"author"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w"></span>
<a href="#__codelineno-42-8" id="__codelineno-42-8" name="__codelineno-42-8"></a><span class="nt">"email"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w"></span>
<a href="#__codelineno-42-9" id="__codelineno-42-9" name="__codelineno-42-9"></a><span class="err">...</span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Dann erstellen wir einen Ordner <code>package</code>, hier wird unser verpacktes Modell gespeichert, und geben folgenden Terminalbefehl ein: </p>
<p><div class="highlight"><pre><span></span><code><a href="#__codelineno-43-1" id="__codelineno-43-1" name="__codelineno-43-1"></a>python -m spacy package ./output/model-best ./package --build wheel
</code></pre></div>
Lokal können wir unser Modell jetzt installieren wie folgt installieren. Wir müssen uns hierfür allerdings im Verzeichnis <code>dist</code> befinden oder dorthin navigieren: </p>
<p><div class="highlight"><pre><span></span><code><a href="#__codelineno-44-1" id="__codelineno-44-1" name="__codelineno-44-1"></a>pip install package/de_fnhd_nerdh-0.0.1/dist/de_fnhd_nerdh-0.0.1-py3-none-any.whl
</code></pre></div>
Jetzt können wir unser selbst erstelltes Modell wie die <code>spaCy</code> Modelle benutzen. </p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-45-1" id="__codelineno-45-1" name="__codelineno-45-1"></a><span class="kn">import</span> <span class="nn">spacy</span> 
<a href="#__codelineno-45-2" id="__codelineno-45-2" name="__codelineno-45-2"></a>
<a href="#__codelineno-45-3" id="__codelineno-45-3" name="__codelineno-45-3"></a><span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">de_fnhd_nerdh</span><span class="p">)</span>
</code></pre></div>
<details class="note"><summary>Modellpackage veröffentlichen</summary><p>Mithilfe von <a href="https://github.com/explosion/spacy-huggingface-hub" target="blank"><code>spacy-huggingface-hub</code></a> können wir unser verpacktes Modell veröffentlichen und anderen Usern anbieten. Dazu müssen wir uns vorher einen Account auf <a href="https://huggingface.co/" target="blank">huggingface.co</a> erstellen und das Package installieren. </p>
<p><div class="highlight"><pre><span></span><code><a href="#__codelineno-46-1" id="__codelineno-46-1" name="__codelineno-46-1"></a>pip install spacy-huggingface-hub
</code></pre></div>
Jetzt können wir uns über das Terminal in <a href="https://huggingface.co/" target="blank">huggingface.co</a> einloggen, damit unser Package unserem Profil zugeordnet wird. Hier werden wir nach einem Token gefragt, den wir <a href="https://huggingface.co/settings/tokens" target="blank">hier</a> abrufen können. </p>
<p><div class="highlight"><pre><span></span><code><a href="#__codelineno-47-1" id="__codelineno-47-1" name="__codelineno-47-1"></a>huggingface-cli login
</code></pre></div>
Mit folgendem Befehl pushen wir unser Projekt auf <a href="https://huggingface.co/" target="blank">huggingface.co</a>. </p>
<p><div class="highlight"><pre><span></span><code><a href="#__codelineno-48-1" id="__codelineno-48-1" name="__codelineno-48-1"></a>python -m spacy huggingface-hub push package/de_fnhd_nerdh-0.0.1/dist/de_fnhd_nerdh-0.0.1-py3-none-any.whl
</code></pre></div>
Der Befehl wird dann zwei Dinge ausgeben: </p>
<ul>
<li>wo das Repository auf <a href="https://huggingface.co/" target="blank">huggingface.co</a> gefunden wird </li>
<li>Link, mit welchem das Modell installiert werden kann</li>
</ul>
</details>
</details>
<p>Das Modell, welches hier im Tutorial erstellt wurde, kann mit diesem Befehl als Python Package installiert werden.</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-49-1" id="__codelineno-49-1" name="__codelineno-49-1"></a>pip install https://huggingface.co/easyh/de_fnhd_nerdh/resolve/main/de_fnhd_nerdh-any-py3-none-any.whl
</code></pre></div>
<p><br/></p>
<div class="admonition int">
<p class="admonition-title">Jupyter Notebooks</p>
<p>Der Code zu diesem Kapitel befindet sich hier: <code>notebooks/04_trainEvaluateModel_spacy.ipynb</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="22:2"><input checked="checked" id="__tabbed_22_1" name="__tabbed_22" type="radio"/><input id="__tabbed_22_2" name="__tabbed_22" type="radio"/><div class="tabbed-labels"><label for="__tabbed_22_1"><span class="twemoji"><svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></span> Github</label><label for="__tabbed_22_2"><span class="twemoji"><svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M64 96c0-35.3 28.7-64 64-64h384c35.3 0 64 28.7 64 64v256h-64V96H128v256H64V96zM0 403.2C0 392.6 8.6 384 19.2 384h601.6c10.6 0 19.2 8.6 19.2 19.2 0 42.4-34.4 76.8-76.8 76.8H76.8C34.4 480 0 445.6 0 403.2zM281 209l-31 31 31 31c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-48-48c-9.4-9.4-9.4-24.6 0-33.9l48-48c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9zm112-34 48 48c9.4 9.4 9.4 24.6 0 33.9l-48 48c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l31-31-31-31c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0z"></path></svg></span> mybinder.org</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><a class="md-button" href="https://github.com/easyh/NerDH/blob/main/notebooks/04_trainEvaluateModel_spacy.ipynb" target="blank">Hier geht es zum Notebook auf Github</a></p>
</div>
<div class="tabbed-block">
<p><a class="md-button" href="https://mybinder.org/v2/gh/easyh/NerDH/HEAD" target="blank">Hier geht es zum Jupyter Notebook auf mybinder.org</a></p>
<p><strong>Das Laden des Workspaces wird einen kurzen Moment in Anspruch nehmen.</strong></p>
</div>
</div>
</div>
</div>
<p><br/></p>
<h3 id="34-evaluierung"><strong>3.4 Evaluierung</strong></h3>
<p>Der nächste logische Schritt ist jetzt natürlich die Evaluation unseres Modells. Hierfür benötigen wir unsere Testdaten. Das Modell wird dann anhand von <strong>F-Score</strong>, <strong>Precision</strong> und <strong>Recall</strong> bewertet. <code>spaCy</code> hat hierfür einen einfachen Terminalbefehl. </p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-50-1" id="__codelineno-50-1" name="__codelineno-50-1"></a>python -m spacy evaluate de_fnhd_nerdh ./data/datensets/testData.spacy
</code></pre></div>
<p>Der Output sollte dann in etwa so aussehen: 
<div class="highlight"><pre><span></span><code><a href="#__codelineno-51-1" id="__codelineno-51-1" name="__codelineno-51-1"></a>ℹ Using CPU
<a href="#__codelineno-51-2" id="__codelineno-51-2" name="__codelineno-51-2"></a>
<a href="#__codelineno-51-3" id="__codelineno-51-3" name="__codelineno-51-3"></a>================================== Results ==================================
<a href="#__codelineno-51-4" id="__codelineno-51-4" name="__codelineno-51-4"></a>
<a href="#__codelineno-51-5" id="__codelineno-51-5" name="__codelineno-51-5"></a>TOK     100.00
<a href="#__codelineno-51-6" id="__codelineno-51-6" name="__codelineno-51-6"></a>NER P   94.85 
<a href="#__codelineno-51-7" id="__codelineno-51-7" name="__codelineno-51-7"></a>NER R   91.06 
<a href="#__codelineno-51-8" id="__codelineno-51-8" name="__codelineno-51-8"></a>NER F   92.92 
<a href="#__codelineno-51-9" id="__codelineno-51-9" name="__codelineno-51-9"></a>SPEED   2297  
<a href="#__codelineno-51-10" id="__codelineno-51-10" name="__codelineno-51-10"></a>
<a href="#__codelineno-51-11" id="__codelineno-51-11" name="__codelineno-51-11"></a>
<a href="#__codelineno-51-12" id="__codelineno-51-12" name="__codelineno-51-12"></a>=============================== NER (per type) ===============================
<a href="#__codelineno-51-13" id="__codelineno-51-13" name="__codelineno-51-13"></a>
<a href="#__codelineno-51-14" id="__codelineno-51-14" name="__codelineno-51-14"></a>                   P       R       F
<a href="#__codelineno-51-15" id="__codelineno-51-15" name="__codelineno-51-15"></a>PERSON         94.81   91.41   93.08
<a href="#__codelineno-51-16" id="__codelineno-51-16" name="__codelineno-51-16"></a>ZEIT           92.64   91.89   92.27
<a href="#__codelineno-51-17" id="__codelineno-51-17" name="__codelineno-51-17"></a>ORT            95.94   94.26   95.09
<a href="#__codelineno-51-18" id="__codelineno-51-18" name="__codelineno-51-18"></a>OBJEKT         94.44   81.79   87.66
<a href="#__codelineno-51-19" id="__codelineno-51-19" name="__codelineno-51-19"></a>ORGANISATION   95.59   82.28   88.44
</code></pre></div>
Mit diesen Werten können wir ziemlich zufrieden sein. Sollte das allerdings nicht der Fall sein, dann würden wir einfach unseren Trainingsprozess mit kleinen Veränderungen erneut starten. Allerdings bedeutet der Wert nur, dass das selbst erstellte Modell <code>de_fnhd_nerdh</code> besonders gut mit Texten von <strong>Philipp Hainhofer</strong> funktioniert (F-Score 0.92), da es mit diesen trainiert wurde. Nur weil ein Text in frühneuhochdeutsch geschrieben wurde, ist dies keine Garantie für ein gutes Ergebnis mit diesem Modell. Der Grund: Historische Texte sind zu spezifisch, als dass sie in einem Modell zusammengefasst werden könnten. </p>
<p><br/></p>
<div class="admonition int">
<p class="admonition-title">Interaktive Notebooks</p>
<p>Der Code zu diesem Kapitel befindet sich hier: <code>notebooks/04_trainEvaluateModel_spacy.ipynb</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="23:2"><input checked="checked" id="__tabbed_23_1" name="__tabbed_23" type="radio"/><input id="__tabbed_23_2" name="__tabbed_23" type="radio"/><div class="tabbed-labels"><label for="__tabbed_23_1"><span class="twemoji"><svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M64 96c0-35.3 28.7-64 64-64h384c35.3 0 64 28.7 64 64v256h-64V96H128v256H64V96zM0 403.2C0 392.6 8.6 384 19.2 384h601.6c10.6 0 19.2 8.6 19.2 19.2 0 42.4-34.4 76.8-76.8 76.8H76.8C34.4 480 0 445.6 0 403.2zM281 209l-31 31 31 31c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-48-48c-9.4-9.4-9.4-24.6 0-33.9l48-48c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9zm112-34 48 48c9.4 9.4 9.4 24.6 0 33.9l-48 48c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l31-31-31-31c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0z"></path></svg></span> mybinder.org</label><label for="__tabbed_23_2"><span class="twemoji"><svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></span> Github</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><a class="md-button" href="https://mybinder.org/v2/gh/easyh/NerDH/HEAD" target="blank">Hier geht es zum Jupyter Notebook auf mybinder.org</a></p>
<p><strong>Das Laden des Workspaces wird einen kurzen Moment in Anspruch nehmen.</strong></p>
</div>
<div class="tabbed-block">
<p><a class="md-button" href="https://github.com/easyh/NerDH/blob/main/notebooks/04_trainEvaluateModel_spacy.ipynb" target="blank">Hier geht es zum Notebook auf Github</a></p>
</div>
</div>
</div>
</div>
<p><br/></p>
<p><br/></p>
<div class="footnote">
<hr/>
<ol>
<li id="fn:1">
<p>spaCy. Industrial-strength Natural Language Processing in Python. <a href="http://web.archive.org/web/20230102123431/https://spacy.io" target="blank">https://spacy.io/</a> <a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn:2">
<p>spaCy. Industrial-strength Natural Language Processing in Python. <a href="http://web.archive.org/web/20230102123639/https://spacy.io/usage" target="blank">https://spacy.io/usage</a> <a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
<li id="fn:3">
<p>spaCy. Industrial-strength Natural Language Processing in Python.<a href="http://web.archive.org/web/20230102123719/https://spacy.io/models/de" target="blank">https://spacy.io/models/de</a> <a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">↩</a></p>
</li>
<li id="fn:4">
<p>Schumacher, M. K. (2020). Named Entity Recognition und Reverse Engineering. Lebe lieber literarisch. <a href="http://web.archive.org/web/20230102124132/https://lebelieberliterarisch.de/named-entity-recognition-und-reverse-engineering/" target="blank">https://lebelieberliterarisch.de/
named-entity-recognition-und-reverse-engineering/</a> <a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 4 in the text">↩</a></p>
</li>
<li id="fn:7">
<p>datasolut GmbH. (2021). Was sind Trainingsdaten im Machine Learning? datasolut Wiki. <a href="http://web.archive.org/web/20230102124244/https://datasolut.com/wiki/trainingsdaten-und-testdaten-machine-learning/" target="blank">https://datasolut.com/wiki/trainingsdaten-und-testdaten-machine-learning/</a> <a class="footnote-backref" href="#fnref:7" title="Jump back to footnote 5 in the text">↩</a></p>
</li>
</ol>
</div>
</article>
</div>
</div>
<a class="md-top md-icon" data-md-component="top" hidden="" href="#">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
            Zurück zum Seitenanfang
          </a>
</main>
<footer class="md-footer">
<nav aria-label="Fußzeile" class="md-footer__inner md-grid">
<a aria-label="Zurück: Named Entity Recognition" class="md-footer__link md-footer__link--prev" href=".." rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Zurück
              </span>
              Named Entity Recognition
            </div>
</div>
</a>
<a aria-label="Weiter: NerDH Visualisierer" class="md-footer__link md-footer__link--next" href="../gui/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Weiter
              </span>
              NerDH Visualisierer
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "..", "features": ["navigation.top", "navigation.tabs", "navigation.expand", "toc.integrate", "content.code.annotate", "content.tabs"], "search": "../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "In Zwischenablage kopiert", "clipboard.copy": "In Zwischenablage kopieren", "search.config.lang": "de", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Suche", "search.result.more.one": "1 weiteres Suchergebnis auf dieser Seite", "search.result.more.other": "# weitere Suchergebnisse auf dieser Seite", "search.result.none": "Keine Suchergebnisse", "search.result.one": "1 Suchergebnis", "search.result.other": "# Suchergebnisse", "search.result.placeholder": "Suchbegriff eingeben", "search.result.term.missing": "Es fehlt", "select.version.title": "Version ausw\u00e4hlen"}}</script>
<script src="../assets/javascripts/bundle.078830c0.min.js"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom"});})</script></body>
</html>